"use strict";var Ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Qo(n){var e=n.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}function He(n){var e=process.version,t=e.split(".")[0];t=t.split("v")[1];var r=e.split(".")[1];t==0&&r<10&&(console.log("Error: Please update to the latest version of node! This library requires 0.10.x or later"),process.exit(0)),this.intervalT1=null,this.timeOutT1=null,this.intervalCount=1,this.deferredInterval=!1,this.deferredTimeout=!1,this.deferredTimeoutRef=null,this.deferredIntervalRef=null,this.timeoutCallbackRef=null,this.intervalCallbackRef=null,this.timeoutImmediateRef=null,this.intervalImmediateRef=null,this.intervalErrorChecked=!1,this.intervalType="",this.timeoutTriggered=!1,n&&(this.logging=!0)}He.prototype.time=function(n,e,t,r){if(r){var a=process.hrtime();e?(e.push(function(){var o=process.hrtime(a);t=="s"?r(o[0]+o[1]/1e9):t=="m"?r(o[0]*1e3+o[1]/1e6):t=="u"?r(o[0]*1e6+o[1]/1e3):t=="n"?r(o[0]*1e9+o[1]):r(o)}),n.apply(null,e)):n(function(){var o=process.hrtime(a);t=="s"?r(o[0]+o[1]/1e9):t=="m"?r(o[0]*1e3+o[1]/1e6):t=="u"?r(o[0]*1e6+o[1]/1e3):t=="n"?r(o[0]*1e9+o[1]):r(o)})}else{var a=process.hrtime();e?n.apply(null,e):n();var s=process.hrtime(a);return t=="s"?s[0]+s[1]/1e9:t=="m"?s[0]*1e3+s[1]/1e6:t=="u"?s[0]*1e6+s[1]/1e3:t=="n"?s[0]*1e9+s[1]:process.hrtime(a)}};He.prototype.setInterval=function(n,e,t,r){this.intervalErrorChecked||(n?typeof n!="function"&&(console.log("Task argument to setInterval must be a function reference"),process.exit(1)):(console.log("A task function must be specified to setInterval"),process.exit(1)),t?typeof t!="string"&&(console.log("Interval argument to setInterval must be a string specified as an integer followed by 's' for seconds, 'm' for milli, 'u' for micro, and 'n' for nanoseconds. Ex. 2u"),process.exit(1)):(console.log("An interval argument must be specified"),process.exit(1)),r&&(typeof r!="function"?(console.log("Callback argument to setInterval must be a function reference"),process.exit(1)):this.intervalCallbackRef=r),this.intervalType=t[t.length-1],this.intervalType=="s"?this.intervalTime=t.slice(0,t.length-1)*1e9:this.intervalType=="m"?this.intervalTime=t.slice(0,t.length-1)*1e6:this.intervalType=="u"?this.intervalTime=t.slice(0,t.length-1)*1e3:this.intervalType=="n"?this.intervalTime=t.slice(0,t.length-1):(console.log("Error with argument: "+t+': Incorrect interval format. Format is an integer followed by "s" for seconds, "m" for milli, "u" for micro, and "n" for nanoseconds. Ex. 2u'),process.exit(1)),this.intervalErrorChecked=!0);var a=this;if(this.intervalTime>0)if(this.intervalT1==null&&(this.intervalT1=process.hrtime()),this.intervalTime*this.intervalCount>8e15&&(this.intervalT1=process.hrtime(),this.intervalCount=1),this.difArray=process.hrtime(this.intervalT1),this.difTime=this.difArray[0]*1e9+this.difArray[1],this.difTime<this.intervalTime*this.intervalCount)if(this.intervalTime>25e6)if(this.deferredInterval==!1){this.deferredInterval=!0;var s=(this.intervalTime-25e6)/1e6;this.deferredIntervalRef=setTimeout(function(){a.setInterval(n,e,t,r)},s)}else this.deferredIntervalRef=null,this.intervalImmediateRef=setImmediate(function(){a.setInterval(n,e,t,r)});else this.intervalImmediateRef=setImmediate(function(){a.setInterval(n,e,t,r)});else this.intervalImmediateRef=null,this.logging&&console.log("nanotimer log: cycle time at - "+this.difTime),e?n.apply(null,e):n(),this.intervalT1&&(this.intervalCount++,this.deferredInterval=!1,this.intervalImmediateRef=setImmediate(function(){a.setInterval(n,e,t,r)}));else this.intervalT1==null&&(this.intervalT1=process.hrtime()),e?n.apply(null,e):n(),this.intervalT1&&(this.intervalImmediateRef=setImmediate(function(){a.setInterval(n,e,t,r)}))};He.prototype.setTimeout=function(n,e,t,r){n?typeof n!="function"&&(console.log("Task argument to setTimeout must be a function reference"),process.exit(1)):(console.log("A task function must be specified to setTimeout"),process.exit(1)),t?typeof t!="string"&&(console.log("Delay argument to setTimeout must be a string specified as an integer followed by 's' for seconds, 'm' for milli, 'u' for micro, and 'n' for nanoseconds. Ex. 2u"),process.exit(1)):(console.log("A delay argument must be specified"),process.exit(1)),r&&(typeof r!="function"?(console.log("Callback argument to setTimeout must be a function reference"),process.exit(1)):this.timeoutCallbackRef=r);var a=this;this.timeoutTriggered&&(this.timeoutTriggered=!1);var s=t[t.length-1];if(s=="s")var o=t.slice(0,t.length-1)*1e9;else if(s=="m")var o=t.slice(0,t.length-1)*1e6;else if(s=="u")var o=t.slice(0,t.length-1)*1e3;else if(s=="n")var o=t.slice(0,t.length-1);else console.log("Error with argument: "+t+': Incorrect delay format. Format is an integer followed by "s" for seconds, "m" for milli, "u" for micro, and "n" for nanoseconds. Ex. 2u'),process.exit(1);this.timeOutT1==null&&(this.timeOutT1=process.hrtime());var l=process.hrtime(this.timeOutT1),c=l[0]*1e9+l[1];if(c<o)if(o>25e6)if(this.deferredTimeout==!1){this.deferredTimeout=!0;var h=(o-25e6)/1e6;this.deferredTimeoutRef=setTimeout(function(){a.setTimeout(n,e,t,r)},h)}else this.deferredTimeoutRef=null,this.timeoutImmediateRef=setImmediate(function(){a.setTimeout(n,e,t,r)});else this.timeoutImmediateRef=setImmediate(function(){a.setTimeout(n,e,t,r)});else if(this.timeoutTriggered=!0,this.timeoutImmediateRef=null,this.timeOutT1=null,this.deferredTimeout=!1,this.logging==!0&&console.log("nanotimer log: actual wait - "+c),e?n.apply(null,e):n(),r){var g={waitTime:c};r(g)}};He.prototype.clearInterval=function(){this.deferredIntervalRef&&(clearTimeout(this.deferredIntervalRef),this.deferredInterval=!1),this.intervalImmediateRef&&clearImmediate(this.intervalImmediateRef),this.intervalT1=null,this.intervalCount=1,this.intervalErrorChecked=!1,this.intervalCallbackRef&&this.intervalCallbackRef()};He.prototype.clearTimeout=function(){if(this.timeoutTriggered==!1){if(this.deferredTimeoutRef){if(clearTimeout(this.deferredTimeoutRef),this.timeOutT1)var n=process.hrtime(this.timeOutT1),e=n[0]*1e9+n[1];this.deferredTimeout=!1}if(this.timeoutImmediateRef&&clearImmediate(this.timeoutImmediateRef),this.timeOutT1=null,this.timeoutCallbackRef){var t={waitTime:e};this.timeoutCallbackRef(t)}}};He.prototype.hasTimeout=function(){return this.timeOutT1!=null};var Yo=He,mi=function(n,e){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])},mi(n,e)};function Pt(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mi(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Lt=function(){return Lt=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Lt.apply(this,arguments)};function u(n,e,t,r){var a=arguments.length,s=a<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(s=(a<3?o(s):a>3?o(e,t,s):o(e,t))||s);return a>3&&s&&Object.defineProperty(e,t,s),s}function Le(n,e,t,r){function a(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(g){try{h(r.next(g))}catch(v){o(v)}}function c(g){try{h(r.throw(g))}catch(v){o(v)}}function h(g){g.done?s(g.value):a(g.value).then(l,c)}h((r=r.apply(n,e||[])).next())})}function Ve(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(h){return function(g){return c([h,g])}}function c(h){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,a&&(s=h[0]&2?a.return:h[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,h[1])).done)return s;switch(a=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,a=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){t.label=h[1];break}if(h[0]===6&&t.label<s[1]){t.label=s[1],s=h;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(h);break}s[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],a=0}finally{r=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Xo(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function Et(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Xo(arguments[e]));return n}function Zo(n){switch(typeof n){case"undefined":return"";case"object":{if(n===null)return"";if("cacheKey"in n)return n.cacheKey;const e=JSON.stringify(n);if(e!=="{}")return e}default:return n.toString()}}function Os(n,e,t){return[n,...e.map(Zo)].join("/")+(t?"/":"")}function Rt(n){return class extends n{constructor(){super(...arguments),this.cache=new Map}getFromCache(e){if(this._cleanCache(),this.cache.has(e)){const t=this.cache.get(e);if(t)return t.value}}setCache(e,t,r){this.cache.set(e,{value:t,expires:Date.now()+r*1e3})}removeFromCache(e,t){const r=this._getInternalCacheKey(e,t);t?this.cache.forEach((a,s)=>{s.startsWith(r)&&this.cache.delete(s)}):this.cache.delete(r)}_cleanCache(){const e=Date.now();this.cache.forEach((t,r)=>{t.expires<e&&this.cache.delete(r)})}_getInternalCacheKey(e,t){if(typeof e=="string"){let r=e;return r.endsWith("/")||(r+="/"),r}else{const r=e.shift();return Os(r,e,t)}}}}function I(n=1/0){return function(e,t,r){if(r.get){const a=r.get;r.get=function(){const s=Os(t,[]),o=this.getFromCache(s);if(o)return o;const l=a.call(this);return this.setCache(s,l,n),l}}return r}}const el=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",tl=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",$i=Object.freeze(Object.defineProperty({__proto__:null,default:tl},Symbol.toStringTag,{value:"Module"}));var me,A;(function(n){n[n.CRITICAL=0]="CRITICAL",n[n.ERROR=1]="ERROR",n[n.WARNING=2]="WARNING",n[n.INFO=3]="INFO",n[n.DEBUG=4]="DEBUG",n[n.TRACE=7]="TRACE"})(A||(A={}));function ji(n){if(typeof n=="number"){if(Object.prototype.hasOwnProperty.call(A,n))return n;var e=Object.keys(A).map(function(r){return parseInt(r,10)}).filter(function(r){return!isNaN(r)&&r<n});return e.length?Math.max.apply(Math,e):A.WARNING}var t=n.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(A,t))throw new Error("Unknown log level string: "+n);return A[t]}var rl=$i?console.log.bind(console):console.debug.bind(console),Ds=(me={},me[A.CRITICAL]=console.error.bind(console),me[A.ERROR]=console.error.bind(console),me[A.WARNING]=console.warn.bind(console),me[A.INFO]=console.info.bind(console),me[A.DEBUG]=rl.bind(console),me[A.TRACE]=console.trace.bind(console),me);function C(n){return n===void 0&&(n=!0),function(e,t){Object.defineProperty(e,t,{get:function(){},set:function(r){Object.defineProperty(this,t,{value:r,writable:!0,enumerable:n})},enumerable:n})}}function _i(n){var e;return(e=[]).concat.apply(e,Et(n))}function nl(n,e){return Object.assign.apply(Object,Et([{}],n.map(e)))}function il(n,e){if(typeof e!="function"){var t=e;e=function(r){return r[t].toString()}}return nl(n,function(r){var a;return a={},a[e(r)]=r,a})}function Hs(n){return n==null}function Ue(n,e){return Hs(n)?null:e(n)}function Us(n,e){return Hs(n)?void 0:e(n)}function al(n){return Et(n).length}var Jr,Qr,Vt=typeof process>"u"?[]:(Qr=(Jr=process.env.LOGGING)===null||Jr===void 0?void 0:Jr.split(";").map(function(n){var e=n.split("=",2),t=e[0],r=e[1];return r?[t==="default"?void 0:t.split(":"),ji(r)]:null}).filter(function(n){return!!n}).sort(function(n,e){var t,r,a=n[0],s=e[0];return((t=s==null?void 0:s.length)!==null&&t!==void 0?t:0)-((r=a==null?void 0:a.length)!==null&&r!==void 0?r:0)}))!==null&&Qr!==void 0?Qr:[],Yr=Vt.findIndex(function(n){var e=n[0];return!e}),Fs=void 0;Yr!==-1&&(Fs=Vt[Yr][1],Vt.splice(Yr));function sl(n,e){return e.length<=n.length&&e.every(function(t,r){return t===n[r]})}function Ns(n){for(var e=n.split(":"),t=0,r=Vt;t<r.length;t++){var a=r[t],s=a[0],o=a[1];if(sl(e,s))return o}return Fs}var $s=function(){function n(e){var t=e.name,r=e.minLevel,a=e.emoji,s=a===void 0?!1:a,o=e.colors,l=e.timestamps,c=l===void 0?$i:l,h,g;this._name=t,this._minLevel=(g=(h=Us(r,function(v){return ji(v)}))!==null&&h!==void 0?h:Ns(t))!==null&&g!==void 0?g:A.WARNING,this._emoji=s,this._colors=o,this._timestamps=c}return n.prototype.crit=function(e){this.log(A.CRITICAL,e)},n.prototype.error=function(e){this.log(A.ERROR,e)},n.prototype.warn=function(e){this.log(A.WARNING,e)},n.prototype.info=function(e){this.log(A.INFO,e)},n.prototype.debug=function(e){this.log(A.DEBUG,e)},n.prototype.trace=function(e){this.log(A.TRACE,e)},n}(),ol=function(n){Pt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){if(!(t>this._minLevel)){var a=Ds[t],s="["+this._name+"] "+r;this._timestamps&&(s="["+new Date().toISOString()+"] "+r),a(s)}},e}($s),ll=function(){function n(e){var t=e.name,r=e.minLevel,a=e.custom,s;this._minLevel=(s=Us(r,function(o){return ji(o)}))!==null&&s!==void 0?s:Ns(t),this._override=typeof a=="function"?{log:a}:a}return n.prototype.log=function(e,t){this._shouldLog(e)&&this._override.log(e,t)},n.prototype.crit=function(e){this._override.crit?this._shouldLog(A.CRITICAL)&&this._override.crit(e):this.log(A.CRITICAL,e)},n.prototype.error=function(e){this._override.error?this._shouldLog(A.ERROR)&&this._override.error(e):this.log(A.ERROR,e)},n.prototype.warn=function(e){this._override.warn?this._shouldLog(A.WARNING)&&this._override.warn(e):this.log(A.WARNING,e)},n.prototype.info=function(e){this._override.info?this._shouldLog(A.INFO)&&this._override.info(e):this.log(A.INFO,e)},n.prototype.debug=function(e){this._override.debug?this._shouldLog(A.DEBUG)&&this._override.debug(e):this.log(A.DEBUG,e)},n.prototype.trace=function(e){this._override.trace?this._shouldLog(A.TRACE)&&this._override.trace(e):this.log(A.TRACE,e)},n.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},n}(),_e,ve,be,ul=(_e={},_e[A.CRITICAL]="\u{1F6D1}",_e[A.ERROR]="\u274C",_e[A.WARNING]="\u26A0\uFE0F ",_e[A.INFO]="\u2139\uFE0F ",_e[A.DEBUG]="\u{1F41E}",_e[A.TRACE]="\u{1F43E}",_e),cl={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},dl={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function Dr(n,e,t){return function(r){return"\x1B["+n+"m"+(t?t(r):r)+"\x1B["+e+"m"}}function de(n){return Dr(cl[n],39)}function nt(n,e){return Dr(dl[n],49,e)}var pl=(ve={},ve[A.CRITICAL]=de("red"),ve[A.ERROR]=de("redBright"),ve[A.WARNING]=de("yellow"),ve[A.INFO]=de("blue"),ve[A.DEBUG]=de("magenta"),ve[A.TRACE]=Dr(0,0),ve),sa=(be={},be[A.CRITICAL]=nt("bgRed",de("white")),be[A.ERROR]=nt("bgRedBright",de("white")),be[A.WARNING]=nt("bgYellow",de("black")),be[A.INFO]=nt("bgBlue",de("white")),be[A.DEBUG]=nt("bgMagenta",de("black")),be[A.TRACE]=Dr(7,27),be),hl=function(n){Pt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){var a,s,o;if(!(t>this._minLevel)){var l=Ds[t],c="";if(this._timestamps&&(c+="["+new Date().toISOString()+"] "),this._emoji){var h=ul[t];c+=h+" "}var g=(o=(a=this._colors)!==null&&a!==void 0?a:(s=process.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&o!==void 0?o:!0;g?c+=sa[t](this._name)+" "+sa[t](A[t])+" "+pl[t](r):c+="["+this._name+":"+A[t].toLowerCase()+"] "+r,l(c)}},e}($s);function ki(n){return n.custom?new ll(n):$i?new hl(n):new ol(n)}var js=function(n){Pt(e,n);function e(){for(var t=this.constructor,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var s=n.apply(this,Et(r))||this,o=t.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(s,o):s.__proto__=o,Error.captureStackTrace&&Error.captureStackTrace(s,t.constructor),s}return Object.defineProperty(e.prototype,"name",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),e}(Error),ks=function(n){Pt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(js),Ms={exports:{}},Ct={exports:{}},fl="Function.prototype.bind called on incompatible ",Xr=Array.prototype.slice,yl=Object.prototype.toString,gl="[object Function]",ml=function(e){var t=this;if(typeof t!="function"||yl.call(t)!==gl)throw new TypeError(fl+t);for(var r=Xr.call(arguments,1),a,s=function(){if(this instanceof a){var g=t.apply(this,r.concat(Xr.call(arguments)));return Object(g)===g?g:this}else return t.apply(e,r.concat(Xr.call(arguments)))},o=Math.max(0,t.length-r.length),l=[],c=0;c<o;c++)l.push("$"+c);if(a=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var h=function(){};h.prototype=t.prototype,a.prototype=new h,h.prototype=null}return a},_l=ml,Mi=Function.prototype.bind||_l,Gi=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var a=42;e[t]=a;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==a||o.enumerable!==!0)return!1}return!0},oa=typeof Symbol<"u"&&Symbol,vl=Gi,Li=function(){return typeof oa!="function"||typeof Symbol!="function"||typeof oa("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:vl()},bl=Mi,Pe=bl.call(Function.call,Object.prototype.hasOwnProperty),O,Ye=SyntaxError,Gs=Function,ze=TypeError,Zr=function(n){try{return Gs('"use strict"; return ('+n+").constructor;")()}catch{}},Oe=Object.getOwnPropertyDescriptor;if(Oe)try{Oe({},"")}catch{Oe=null}var en=function(){throw new ze},wl=Oe?function(){try{return arguments.callee,en}catch{try{return Oe(arguments,"callee").get}catch{return en}}}():en,ke=Li(),we=Object.getPrototypeOf||function(n){return n.__proto__},Me={},xl=typeof Uint8Array>"u"?O:we(Uint8Array),Ke={"%AggregateError%":typeof AggregateError>"u"?O:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?O:ArrayBuffer,"%ArrayIteratorPrototype%":ke?we([][Symbol.iterator]()):O,"%AsyncFromSyncIteratorPrototype%":O,"%AsyncFunction%":Me,"%AsyncGenerator%":Me,"%AsyncGeneratorFunction%":Me,"%AsyncIteratorPrototype%":Me,"%Atomics%":typeof Atomics>"u"?O:Atomics,"%BigInt%":typeof BigInt>"u"?O:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?O:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?O:Float32Array,"%Float64Array%":typeof Float64Array>"u"?O:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?O:FinalizationRegistry,"%Function%":Gs,"%GeneratorFunction%":Me,"%Int8Array%":typeof Int8Array>"u"?O:Int8Array,"%Int16Array%":typeof Int16Array>"u"?O:Int16Array,"%Int32Array%":typeof Int32Array>"u"?O:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ke?we(we([][Symbol.iterator]())):O,"%JSON%":typeof JSON=="object"?JSON:O,"%Map%":typeof Map>"u"?O:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ke?O:we(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?O:Promise,"%Proxy%":typeof Proxy>"u"?O:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?O:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?O:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ke?O:we(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?O:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ke?we(""[Symbol.iterator]()):O,"%Symbol%":ke?Symbol:O,"%SyntaxError%":Ye,"%ThrowTypeError%":wl,"%TypedArray%":xl,"%TypeError%":ze,"%Uint8Array%":typeof Uint8Array>"u"?O:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?O:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?O:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?O:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?O:WeakMap,"%WeakRef%":typeof WeakRef>"u"?O:WeakRef,"%WeakSet%":typeof WeakSet>"u"?O:WeakSet},Sl=function n(e){var t;if(e==="%AsyncFunction%")t=Zr("async function () {}");else if(e==="%GeneratorFunction%")t=Zr("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Zr("async function* () {}");else if(e==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=n("%AsyncGenerator%");a&&(t=we(a.prototype))}return Ke[e]=t,t},la={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Bt=Mi,Wt=Pe,Al=Bt.call(Function.call,Array.prototype.concat),Il=Bt.call(Function.apply,Array.prototype.splice),ua=Bt.call(Function.call,String.prototype.replace),zt=Bt.call(Function.call,String.prototype.slice),Tl=Bt.call(Function.call,RegExp.prototype.exec),Pl=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,El=/\\(\\)?/g,Rl=function(e){var t=zt(e,0,1),r=zt(e,-1);if(t==="%"&&r!=="%")throw new Ye("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new Ye("invalid intrinsic syntax, expected opening `%`");var a=[];return ua(e,Pl,function(s,o,l,c){a[a.length]=l?ua(c,El,"$1"):o||s}),a},Cl=function(e,t){var r=e,a;if(Wt(la,r)&&(a=la[r],r="%"+a[0]+"%"),Wt(Ke,r)){var s=Ke[r];if(s===Me&&(s=Sl(r)),typeof s>"u"&&!t)throw new ze("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:r,value:s}}throw new Ye("intrinsic "+e+" does not exist!")},j=function(e,t){if(typeof e!="string"||e.length===0)throw new ze("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new ze('"allowMissing" argument must be a boolean');if(Tl(/^%?[^%]*%?$/g,e)===null)throw new Ye("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=Rl(e),a=r.length>0?r[0]:"",s=Cl("%"+a+"%",t),o=s.name,l=s.value,c=!1,h=s.alias;h&&(a=h[0],Il(r,Al([0,1],h)));for(var g=1,v=!0;g<r.length;g+=1){var _=r[g],m=zt(_,0,1),x=zt(_,-1);if((m==='"'||m==="'"||m==="`"||x==='"'||x==="'"||x==="`")&&m!==x)throw new Ye("property names with quotes must have matching quotes");if((_==="constructor"||!v)&&(c=!0),a+="."+_,o="%"+a+"%",Wt(Ke,o))l=Ke[o];else if(l!=null){if(!(_ in l)){if(!t)throw new ze("base intrinsic for "+e+" exists, but the property is not available.");return}if(Oe&&g+1>=r.length){var B=Oe(l,_);v=!!B,v&&"get"in B&&!("originalValue"in B.get)?l=B.get:l=l[_]}else v=Wt(l,_),l=l[_];v&&!c&&(Ke[o]=l)}}return l};(function(n){var e=Mi,t=j,r=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),s=t("%Reflect.apply%",!0)||e.call(a,r),o=t("%Object.getOwnPropertyDescriptor%",!0),l=t("%Object.defineProperty%",!0),c=t("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}n.exports=function(v){var _=s(e,a,arguments);if(o&&l){var m=o(_,"length");m.configurable&&l(_,"length",{value:1+c(0,v.length-(arguments.length-1))})}return _};var h=function(){return s(e,r,arguments)};l?l(n.exports,"apply",{value:h}):n.exports.apply=h})(Ct);var ca=Object.prototype.toString,Ls=function(e){var t=ca.call(e),r=t==="[object Arguments]";return r||(r=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&ca.call(e.callee)==="[object Function]"),r},tn,da;function Bl(){if(da)return tn;da=1;var n;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=Ls,a=Object.prototype.propertyIsEnumerable,s=!a.call({toString:null},"toString"),o=a.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(_){var m=_.constructor;return m&&m.prototype===_},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if(typeof window>"u")return!1;for(var _ in window)try{if(!h["$"+_]&&e.call(window,_)&&window[_]!==null&&typeof window[_]=="object")try{c(window[_])}catch{return!0}}catch{return!0}return!1}(),v=function(_){if(typeof window>"u"||!g)return c(_);try{return c(_)}catch{return!1}};n=function(m){var x=m!==null&&typeof m=="object",B=t.call(m)==="[object Function]",T=r(m),D=x&&t.call(m)==="[object String]",k=[];if(!x&&!B&&!T)throw new TypeError("Object.keys called on a non-object");var N=o&&B;if(D&&m.length>0&&!e.call(m,0))for(var H=0;H<m.length;++H)k.push(String(H));if(T&&m.length>0)for(var Q=0;Q<m.length;++Q)k.push(String(Q));else for(var M in m)!(N&&M==="prototype")&&e.call(m,M)&&k.push(String(M));if(s)for(var ie=v(m),q=0;q<l.length;++q)!(ie&&l[q]==="constructor")&&e.call(m,l[q])&&k.push(l[q]);return k}}return tn=n,tn}var ql=Array.prototype.slice,Ol=Ls,pa=Object.keys,Nt=pa?function(e){return pa(e)}:Bl(),ha=Object.keys;Nt.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(r){return Ol(r)?ha(ql.call(r)):ha(r)})}else Object.keys=Nt;return Object.keys||Nt};var Dl=Nt,Hl=j,vi=Hl("%Object.defineProperty%",!0),bi=function(){if(vi)try{return vi({},"a",{value:1}),!0}catch{return!1}return!1};bi.hasArrayLengthDefineBug=function(){if(!bi())return null;try{return vi([],"length",{value:1}).length!==1}catch{return!0}};var Vs=bi,Ul=Dl,Fl=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Nl=Object.prototype.toString,$l=Array.prototype.concat,Ws=Object.defineProperty,jl=function(n){return typeof n=="function"&&Nl.call(n)==="[object Function]"},kl=Vs(),zs=Ws&&kl,Ml=function(n,e,t,r){e in n&&(!jl(r)||!r())||(zs?Ws(n,e,{configurable:!0,enumerable:!1,value:t,writable:!0}):n[e]=t)},Ks=function(n,e){var t=arguments.length>2?arguments[2]:{},r=Ul(e);Fl&&(r=$l.call(r,Object.getOwnPropertySymbols(e)));for(var a=0;a<r.length;a+=1)Ml(n,r[a],e[r[a]],t[r[a]])};Ks.supportsDescriptors=!!zs;var Hr=Ks,Ur=function(){if(typeof Promise!="function")throw new TypeError("`Promise.allSettled` requires a global `Promise` be available.")},rn,fa;function Gl(){if(fa)return rn;fa=1;var n=j,e=Ct.exports,t=n("%Promise.resolve%",!0),r=t&&e(t);return rn=function(s,o){if(!r)throw new SyntaxError("This environment does not support Promises.");return r(s,o)},rn}var nn,ya;function Js(){return ya||(ya=1,nn=function(e){if(e===null)return"Null";if(typeof e>"u")return"Undefined";if(typeof e=="function"||typeof e=="object")return"Object";if(typeof e=="number")return"Number";if(typeof e=="boolean")return"Boolean";if(typeof e=="string")return"String"}),nn}var an,ga;function Ll(){if(ga)return an;ga=1;var n=Js();return an=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":n(t)},an}var it={exports:{}},sn,ma;function Fr(){if(ma)return sn;ma=1;var n=Gi;return sn=function(){return n()&&!!Symbol.toStringTag},sn}var on,_a;function ue(){if(_a)return on;_a=1;var n=j,e=Ct.exports,t=e(n("String.prototype.indexOf"));return on=function(a,s){var o=n(a,!!s);return typeof o=="function"&&t(a,".prototype.")>-1?e(o):o},on}var ln,va;function Vl(){if(va)return ln;va=1;var n=Fr()(),e=ue(),t=e("Object.prototype.toString"),r=function(l){return n&&l&&typeof l=="object"&&Symbol.toStringTag in l?!1:t(l)==="[object Arguments]"},a=function(l){return r(l)?!0:l!==null&&typeof l=="object"&&typeof l.length=="number"&&l.length>=0&&t(l)!=="[object Array]"&&t(l.callee)==="[object Function]"},s=function(){return r(arguments)}();return r.isLegacyArguments=a,ln=s?r:a,ln}var un,ba;function Wl(){if(ba)return un;ba=1;var n={}.toString;return un=Array.isArray||function(e){return n.call(e)=="[object Array]"},un}var cn,wa;function Qs(){if(wa)return cn;wa=1;var n=String.prototype.valueOf,e=function(o){try{return n.call(o),!0}catch{return!1}},t=Object.prototype.toString,r="[object String]",a=Fr()();return cn=function(o){return typeof o=="string"?!0:typeof o!="object"?!1:a?e(o):t.call(o)===r},cn}var dn,xa;function zl(){if(xa)return dn;xa=1;var n=typeof Map=="function"&&Map.prototype?Map:null,e=typeof Set=="function"&&Set.prototype?Set:null,t;n||(t=function(o){return!1});var r=n?Map.prototype.has:null,a=e?Set.prototype.has:null;return!t&&!r&&(t=function(o){return!1}),dn=t||function(o){if(!o||typeof o!="object")return!1;try{if(r.call(o),a)try{a.call(o)}catch{return!0}return o instanceof n}catch{}return!1},dn}var pn,Sa;function Kl(){if(Sa)return pn;Sa=1;var n=typeof Map=="function"&&Map.prototype?Map:null,e=typeof Set=="function"&&Set.prototype?Set:null,t;e||(t=function(o){return!1});var r=n?Map.prototype.has:null,a=e?Set.prototype.has:null;return!t&&!a&&(t=function(o){return!1}),pn=t||function(o){if(!o||typeof o!="object")return!1;try{if(a.call(o),r)try{r.call(o)}catch{return!0}return o instanceof e}catch{}return!1},pn}var Aa;function Jl(){if(Aa)return it.exports;Aa=1;var n=Vl();if(Li()||Gi()){var e=Symbol.iterator;it.exports=function(P){if(P!=null&&typeof P[e]<"u")return P[e]();if(n(P))return Array.prototype[e].call(P)}}else{var t=Wl(),r=Qs(),a=j,s=a("%Map%",!0),o=a("%Set%",!0),l=ue(),c=l("Array.prototype.push"),h=l("String.prototype.charCodeAt"),g=l("String.prototype.slice"),v=function(P,J){var W=P.length;if(J+1>=W)return J+1;var re=h(P,J);if(re<55296||re>56319)return J+1;var Z=h(P,J+1);return Z<56320||Z>57343?J+1:J+2},_=function(P){var J=0;return{next:function(){var re=J>=P.length,Z;return re||(Z=P[J],J+=1),{done:re,value:Z}}}},m=function(P,J){if(t(P)||n(P))return _(P);if(r(P)){var W=0;return{next:function(){var Z=v(P,W),f=g(P,W,Z);return W=Z,{done:Z>P.length,value:f}}}}if(J&&typeof P["_es6-shim iterator_"]<"u")return P["_es6-shim iterator_"]()};if(!s&&!o)it.exports=function(P){if(P!=null)return m(P,!0)};else{var x=zl(),B=Kl(),T=l("Map.prototype.forEach",!0),D=l("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var k=l("Map.prototype.iterator",!0),N=l("Set.prototype.iterator",!0),H=function(q){var P=!1;return{next:function(){try{return{done:P,value:P?void 0:q.next()}}catch{return P=!0,{done:!0,value:void 0}}}}};var Q=l("Map.prototype.@@iterator",!0)||l("Map.prototype._es6-shim iterator_",!0),M=l("Set.prototype.@@iterator",!0)||l("Set.prototype._es6-shim iterator_",!0),ie=function(P){if(x(P)){if(k)return H(k(P));if(Q)return Q(P);if(T){var J=[];return T(P,function(re,Z){c(J,[Z,re])}),_(J)}}if(B(P)){if(N)return H(N(P));if(M)return M(P);if(D){var W=[];return D(P,function(re){c(W,re)}),_(W)}}};it.exports=function(P){return ie(P)||m(P)}}}return it.exports}var hn,Ia;function Ql(){if(Ia)return hn;Ia=1;var n=TypeError;return hn=function(t){if(!t||typeof t.next!="function")throw new n("iterator must be an object with a `next` method");if(arguments.length>1){var r=arguments[1];if(typeof r!="function")throw new n("`callback`, if provided, must be a function")}for(var a=r||[],s;(s=t.next())&&!s.done;)r?r(s.value):a.push(s.value);if(!r)return a},hn}var fn,Ta;function Yl(){if(Ta)return fn;Ta=1;var n=Jl(),e=TypeError,t=Ql();return fn=function(a){var s=n(a);if(!s)throw new e("non-iterable value provided");return arguments.length>1?t(s,arguments[1]):t(s)},fn}var yn={exports:{}},gn,Pa;function Xl(){if(Pa)return gn;Pa=1;var n=j,e=n("%TypeError%");return gn=function(r,a){if(r==null)throw new e(a||"Cannot call method on "+r);return r},gn}var Ea;function Ys(){return Ea||(Ea=1,function(n){n.exports=Xl()}(yn)),yn.exports}var mn,Ra;function Zl(){if(Ra)return mn;Ra=1;var n=j,e=n("%Math.abs%");return mn=function(r){return e(r)},mn}var _n,Ca;function eu(){if(Ca)return _n;Ca=1;var n=Math.floor;return _n=function(t){return n(t)},_n}var vn,Ba;function oe(){if(Ba)return vn;Ba=1;var n=Js();return vn=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":n(t)},vn}var bn,qa;function Xs(){return qa||(qa=1,bn=Number.isNaN||function(e){return e!==e}),bn}var wn,Oa;function tu(){if(Oa)return wn;Oa=1;var n=Number.isNaN||function(e){return e!==e};return wn=Number.isFinite||function(e){return typeof e=="number"&&!n(e)&&e!==1/0&&e!==-1/0},wn}var xn,Da;function Zs(){if(Da)return xn;Da=1;var n=Zl(),e=eu(),t=oe(),r=Xs(),a=tu();return xn=function(o){if(t(o)!=="Number"||r(o)||!a(o))return!1;var l=n(o);return e(l)===l},xn}var Sn,Ha;function ru(){if(Ha)return Sn;Ha=1;var n=j,e=n("%Array.prototype%"),t=n("%RangeError%"),r=n("%SyntaxError%"),a=n("%TypeError%"),s=Zs(),o=Math.pow(2,32)-1,l=n("%Object.setPrototypeOf%",!0)||([].__proto__!==e?null:function(c,h){return c.__proto__=h,c});return Sn=function(h){if(!s(h)||h<0)throw new a("Assertion failed: `length` must be an integer Number >= 0");if(h>o)throw new t("length is greater than (2**32 - 1)");var g=arguments.length>1?arguments[1]:e,v=[];if(g!==e){if(!l)throw new r("ArrayCreate: a `proto` argument that is not `Array.prototype` is not supported in an environment that does not support setting the [[Prototype]]");l(v,g)}return h!==0&&(v.length=h),v},Sn}const nu=new Proxy({},{get(n,e){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${e}" in client code.`)}}),iu=Object.freeze(Object.defineProperty({__proto__:null,default:nu},Symbol.toStringTag,{value:"Module"})),au=Qo(iu);var An,Ua;function su(){if(Ua)return An;Ua=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=n&&e&&typeof e.get=="function"?e.get:null,r=n&&Map.prototype.forEach,a=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=a&&s&&typeof s.get=="function"?s.get:null,l=a&&Set.prototype.forEach,c=typeof WeakMap=="function"&&WeakMap.prototype,h=c?WeakMap.prototype.has:null,g=typeof WeakSet=="function"&&WeakSet.prototype,v=g?WeakSet.prototype.has:null,_=typeof WeakRef=="function"&&WeakRef.prototype,m=_?WeakRef.prototype.deref:null,x=Boolean.prototype.valueOf,B=Object.prototype.toString,T=Function.prototype.toString,D=String.prototype.match,k=String.prototype.slice,N=String.prototype.replace,H=String.prototype.toUpperCase,Q=String.prototype.toLowerCase,M=RegExp.prototype.test,ie=Array.prototype.concat,q=Array.prototype.join,P=Array.prototype.slice,J=Math.floor,W=typeof BigInt=="function"?BigInt.prototype.valueOf:null,re=Object.getOwnPropertySymbols,Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,f=typeof Symbol=="function"&&typeof Symbol.iterator=="object",b=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===f?"object":"symbol")?Symbol.toStringTag:null,E=Object.prototype.propertyIsEnumerable,ee=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(p){return p.__proto__}:null);function X(p,y){if(p===1/0||p===-1/0||p!==p||p&&p>-1e3&&p<1e3||M.call(/e/,y))return y;var F=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof p=="number"){var G=p<0?-J(-p):J(p);if(G!==p){var Y=String(G),R=k.call(y,Y.length+1);return N.call(Y,F,"$&_")+"."+N.call(N.call(R,/([0-9]{3})/g,"$&_"),/_$/,"")}}return N.call(y,F,"$&_")}var U=au,Ee=U.custom,pe=Ki(Ee)?Ee:null;An=function p(y,F,G,Y){var R=F||{};if(he(R,"quoteStyle")&&R.quoteStyle!=="single"&&R.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(he(R,"maxStringLength")&&(typeof R.maxStringLength=="number"?R.maxStringLength<0&&R.maxStringLength!==1/0:R.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var ye=he(R,"customInspect")?R.customInspect:!0;if(typeof ye!="boolean"&&ye!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(he(R,"indent")&&R.indent!==null&&R.indent!=="	"&&!(parseInt(R.indent,10)===R.indent&&R.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(he(R,"numericSeparator")&&typeof R.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Re=R.numericSeparator;if(typeof y>"u")return"undefined";if(y===null)return"null";if(typeof y=="boolean")return y?"true":"false";if(typeof y=="string")return Qi(y,R);if(typeof y=="number"){if(y===0)return 1/0/y>0?"0":"-0";var ae=String(y);return Re?X(y,ae):ae}if(typeof y=="bigint"){var ge=String(y)+"n";return Re?X(y,ge):ge}var Mr=typeof R.depth>"u"?5:R.depth;if(typeof G>"u"&&(G=0),G>=Mr&&Mr>0&&typeof y=="object")return $r(y)?"[Array]":"[Object]";var $e=Vo(R,G);if(typeof Y>"u")Y=[];else if(Ji(Y,y)>=0)return"[Circular]";function le(je,Dt,zo){if(Dt&&(Y=P.call(Y),Y.push(Dt)),zo){var aa={depth:R.depth};return he(R,"quoteStyle")&&(aa.quoteStyle=R.quoteStyle),p(je,aa,G+1,Y)}return p(je,R,G+1,Y)}if(typeof y=="function"&&!zi(y)){var Xi=Uo(y),Zi=qt(y,le);return"[Function"+(Xi?": "+Xi:" (anonymous)")+"]"+(Zi.length>0?" { "+q.call(Zi,", ")+" }":"")}if(Ki(y)){var ea=f?N.call(String(y),/^(Symbol\(.*\))_[^)]*$/,"$1"):Z.call(y);return typeof y=="object"&&!f?tt(ea):ea}if(Mo(y)){for(var rt="<"+Q.call(String(y.nodeName)),Gr=y.attributes||[],Ot=0;Ot<Gr.length;Ot++)rt+=" "+Gr[Ot].name+"="+Ne(Eo(Gr[Ot].value),"double",R);return rt+=">",y.childNodes&&y.childNodes.length&&(rt+="..."),rt+="</"+Q.call(String(y.nodeName))+">",rt}if($r(y)){if(y.length===0)return"[]";var Lr=qt(y,le);return $e&&!Lo(Lr)?"["+kr(Lr,$e)+"]":"[ "+q.call(Lr,", ")+" ]"}if(Co(y)){var Vr=qt(y,le);return!("cause"in Error.prototype)&&"cause"in y&&!E.call(y,"cause")?"{ ["+String(y)+"] "+q.call(ie.call("[cause]: "+le(y.cause),Vr),", ")+" }":Vr.length===0?"["+String(y)+"]":"{ ["+String(y)+"] "+q.call(Vr,", ")+" }"}if(typeof y=="object"&&ye){if(pe&&typeof y[pe]=="function"&&U)return U(y,{depth:Mr-G});if(ye!=="symbol"&&typeof y.inspect=="function")return y.inspect()}if(Fo(y)){var ta=[];return r.call(y,function(je,Dt){ta.push(le(Dt,y,!0)+" => "+le(je,y))}),Yi("Map",t.call(y),ta,$e)}if(jo(y)){var ra=[];return l.call(y,function(je){ra.push(le(je,y))}),Yi("Set",o.call(y),ra,$e)}if(No(y))return jr("WeakMap");if(ko(y))return jr("WeakSet");if($o(y))return jr("WeakRef");if(qo(y))return tt(le(Number(y)));if(Do(y))return tt(le(W.call(y)));if(Oo(y))return tt(x.call(y));if(Bo(y))return tt(le(String(y)));if(!Ro(y)&&!zi(y)){var Wr=qt(y,le),na=ee?ee(y)===Object.prototype:y instanceof Object||y.constructor===Object,zr=y instanceof Object?"":"null prototype",ia=!na&&b&&Object(y)===y&&b in y?k.call(fe(y),8,-1):zr?"Object":"",Wo=na||typeof y.constructor!="function"?"":y.constructor.name?y.constructor.name+" ":"",Kr=Wo+(ia||zr?"["+q.call(ie.call([],ia||[],zr||[]),": ")+"] ":"");return Wr.length===0?Kr+"{}":$e?Kr+"{"+kr(Wr,$e)+"}":Kr+"{ "+q.call(Wr,", ")+" }"}return String(y)};function Ne(p,y,F){var G=(F.quoteStyle||y)==="double"?'"':"'";return G+p+G}function Eo(p){return N.call(String(p),/"/g,"&quot;")}function $r(p){return fe(p)==="[object Array]"&&(!b||!(typeof p=="object"&&b in p))}function Ro(p){return fe(p)==="[object Date]"&&(!b||!(typeof p=="object"&&b in p))}function zi(p){return fe(p)==="[object RegExp]"&&(!b||!(typeof p=="object"&&b in p))}function Co(p){return fe(p)==="[object Error]"&&(!b||!(typeof p=="object"&&b in p))}function Bo(p){return fe(p)==="[object String]"&&(!b||!(typeof p=="object"&&b in p))}function qo(p){return fe(p)==="[object Number]"&&(!b||!(typeof p=="object"&&b in p))}function Oo(p){return fe(p)==="[object Boolean]"&&(!b||!(typeof p=="object"&&b in p))}function Ki(p){if(f)return p&&typeof p=="object"&&p instanceof Symbol;if(typeof p=="symbol")return!0;if(!p||typeof p!="object"||!Z)return!1;try{return Z.call(p),!0}catch{}return!1}function Do(p){if(!p||typeof p!="object"||!W)return!1;try{return W.call(p),!0}catch{}return!1}var Ho=Object.prototype.hasOwnProperty||function(p){return p in this};function he(p,y){return Ho.call(p,y)}function fe(p){return B.call(p)}function Uo(p){if(p.name)return p.name;var y=D.call(T.call(p),/^function\s*([\w$]+)/);return y?y[1]:null}function Ji(p,y){if(p.indexOf)return p.indexOf(y);for(var F=0,G=p.length;F<G;F++)if(p[F]===y)return F;return-1}function Fo(p){if(!t||!p||typeof p!="object")return!1;try{t.call(p);try{o.call(p)}catch{return!0}return p instanceof Map}catch{}return!1}function No(p){if(!h||!p||typeof p!="object")return!1;try{h.call(p,h);try{v.call(p,v)}catch{return!0}return p instanceof WeakMap}catch{}return!1}function $o(p){if(!m||!p||typeof p!="object")return!1;try{return m.call(p),!0}catch{}return!1}function jo(p){if(!o||!p||typeof p!="object")return!1;try{o.call(p);try{t.call(p)}catch{return!0}return p instanceof Set}catch{}return!1}function ko(p){if(!v||!p||typeof p!="object")return!1;try{v.call(p,v);try{h.call(p,h)}catch{return!0}return p instanceof WeakSet}catch{}return!1}function Mo(p){return!p||typeof p!="object"?!1:typeof HTMLElement<"u"&&p instanceof HTMLElement?!0:typeof p.nodeName=="string"&&typeof p.getAttribute=="function"}function Qi(p,y){if(p.length>y.maxStringLength){var F=p.length-y.maxStringLength,G="... "+F+" more character"+(F>1?"s":"");return Qi(k.call(p,0,y.maxStringLength),y)+G}var Y=N.call(N.call(p,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Go);return Ne(Y,"single",y)}function Go(p){var y=p.charCodeAt(0),F={8:"b",9:"t",10:"n",12:"f",13:"r"}[y];return F?"\\"+F:"\\x"+(y<16?"0":"")+H.call(y.toString(16))}function tt(p){return"Object("+p+")"}function jr(p){return p+" { ? }"}function Yi(p,y,F,G){var Y=G?kr(F,G):q.call(F,", ");return p+" ("+y+") {"+Y+"}"}function Lo(p){for(var y=0;y<p.length;y++)if(Ji(p[y],`
`)>=0)return!1;return!0}function Vo(p,y){var F;if(p.indent==="	")F="	";else if(typeof p.indent=="number"&&p.indent>0)F=q.call(Array(p.indent+1)," ");else return null;return{base:F,prev:q.call(Array(y+1),F)}}function kr(p,y){if(p.length===0)return"";var F=`
`+y.prev+y.base;return F+q.call(p,","+F)+`
`+y.prev}function qt(p,y){var F=$r(p),G=[];if(F){G.length=p.length;for(var Y=0;Y<p.length;Y++)G[Y]=he(p,Y)?y(p[Y],p):""}var R=typeof re=="function"?re(p):[],ye;if(f){ye={};for(var Re=0;Re<R.length;Re++)ye["$"+R[Re]]=R[Re]}for(var ae in p)!he(p,ae)||F&&String(Number(ae))===ae&&ae<p.length||f&&ye["$"+ae]instanceof Symbol||(M.call(/[^\w$]/,ae)?G.push(y(ae,p)+": "+y(p[ae],p)):G.push(ae+": "+y(p[ae],p)));if(typeof re=="function")for(var ge=0;ge<R.length;ge++)E.call(p,R[ge])&&G.push("["+y(R[ge])+"]: "+y(p[R[ge]],p));return G}return An}var In,Fa;function et(){return Fa||(Fa=1,In=function(e){return typeof e=="string"||typeof e=="symbol"}),In}var Tn,Na;function eo(){if(Na)return Tn;Na=1;var n=j,e=n("%TypeError%"),t=su(),r=et(),a=oe();return Tn=function(o,l){if(a(o)!=="Object")throw new e("Assertion failed: Type(O) is not Object");if(!r(l))throw new e("Assertion failed: IsPropertyKey(P) is not true, got "+t(l));return o[l]},Tn}var Pn={exports:{}},En,$a;function to(){if($a)return En;$a=1;var n=j,e=n("%Array%"),t=!e.isArray&&ue()("Object.prototype.toString");return En=e.isArray||function(a){return t(a)==="[object Array]"},En}var ja;function Vi(){return ja||(ja=1,function(n){n.exports=to()}(Pn)),Pn.exports}var Ht={exports:{}},Rn={exports:{}},ka;function ou(){return ka||(ka=1,function(n){n.exports=j}(Rn)),Rn.exports}var Cn,Ma;function lu(){if(Ma)return Cn;Ma=1;var n=j,e=Pe,t=n("%TypeError%");return Cn=function(a,s){if(a.Type(s)!=="Object")return!1;var o={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var l in s)if(e(s,l)&&!o[l])return!1;if(a.IsDataDescriptor(s)&&a.IsAccessorDescriptor(s))throw new t("Property Descriptors may not be both accessor and data descriptors");return!0},Cn}var Bn,Ga;function ro(){if(Ga)return Bn;Ga=1;var n=Vs,e=j,t=n()&&e("%Object.defineProperty%",!0),r=n.hasArrayLengthDefineBug(),a=r&&to(),s=ue(),o=s("Object.prototype.propertyIsEnumerable");return Bn=function(c,h,g,v,_,m){if(!t){if(!c(m)||!m["[[Configurable]]"]||!m["[[Writable]]"]||_ in v&&o(v,_)!==!!m["[[Enumerable]]"])return!1;var x=m["[[Value]]"];return v[_]=x,h(v[_],x)}return r&&_==="length"&&"[[Value]]"in m&&a(v)&&v.length!==m["[[Value]]"]?(v.length=m["[[Value]]"],v.length===m["[[Value]]"]):(t(v,_,g(m)),!0)},Bn}var qn,La;function uu(){if(La)return qn;La=1;var n=Pe;return qn=function(t){return n(t,"[[StartIndex]]")&&n(t,"[[EndIndex]]")&&t["[[StartIndex]]"]>=0&&t["[[EndIndex]]"]>=t["[[StartIndex]]"]&&String(parseInt(t["[[StartIndex]]"],10))===String(t["[[StartIndex]]"])&&String(parseInt(t["[[EndIndex]]"],10))===String(t["[[EndIndex]]"])},qn}var On,Va;function Wi(){if(Va)return On;Va=1;var n=j,e=n("%TypeError%"),t=n("%SyntaxError%"),r=Pe,a=uu(),s={"Property Descriptor":function(l){var c={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var h in l)if(r(l,h)&&!c[h])return!1;var g=r(l,"[[Value]]"),v=r(l,"[[Get]]")||r(l,"[[Set]]");if(g&&v)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},"Match Record":a};return On=function(l,c,h,g){var v=s[c];if(typeof v!="function")throw new t("unknown record type: "+c);if(l(g)!=="Object"||!v(g))throw new e(h+" must be a "+c)},On}var Dn,Wa;function cu(){return Wa||(Wa=1,Dn=function(e){if(typeof e>"u")return e;var t={};return"[[Value]]"in e&&(t.value=e["[[Value]]"]),"[[Writable]]"in e&&(t.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(t.get=e["[[Get]]"]),"[[Set]]"in e&&(t.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(t.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(t.configurable=!!e["[[Configurable]]"]),t}),Dn}var Hn,za;function no(){if(za)return Hn;za=1;var n=Wi(),e=cu(),t=oe();return Hn=function(a){return typeof a<"u"&&n(t,"Property Descriptor","Desc",a),e(a)},Hn}var Un,Ka;function du(){if(Ka)return Un;Ka=1;var n=Pe,e=Wi(),t=oe();return Un=function(a){return!(typeof a>"u"||(e(t,"Property Descriptor","Desc",a),!n(a,"[[Get]]")&&!n(a,"[[Set]]")))},Un}var Fn,Ja;function io(){if(Ja)return Fn;Ja=1;var n=Pe,e=Wi(),t=oe();return Fn=function(a){return!(typeof a>"u"||(e(t,"Property Descriptor","Desc",a),!n(a,"[[Value]]")&&!n(a,"[[Writable]]")))},Fn}var Nn,Qa;function ao(){if(Qa)return Nn;Qa=1;var n=Xs();return Nn=function(t,r){return t===r?t===0?1/t===1/r:!0:n(t)&&n(r)},Nn}var $n,Ya;function so(){return Ya||(Ya=1,$n=function(e){return!!e}),$n}var jn={exports:{}},kn,Xa;function oo(){if(Xa)return kn;Xa=1;var n=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,r;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},e(function(){throw 42},null,t)}catch(_){_!==r&&(e=null)}else e=null;var a=/^\s*class\b/,s=function(m){try{var x=n.call(m);return a.test(x)}catch{return!1}},o=function(m){try{return s(m)?!1:(n.call(m),!0)}catch{return!1}},l=Object.prototype.toString,c="[object Function]",h="[object GeneratorFunction]",g=typeof Symbol=="function"&&!!Symbol.toStringTag,v=typeof document=="object"&&typeof document.all>"u"&&document.all!==void 0?document.all:{};return kn=e?function(m){if(m===v)return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;if(typeof m=="function"&&!m.prototype)return!0;try{e(m,null,t)}catch(x){if(x!==r)return!1}return!s(m)}:function(m){if(m===v)return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;if(typeof m=="function"&&!m.prototype)return!0;if(g)return o(m);if(s(m))return!1;var x=l.call(m);return x===c||x===h},kn}var Za;function lo(){return Za||(Za=1,function(n){n.exports=oo()}(jn)),jn.exports}var Mn,es;function uo(){if(es)return Mn;es=1;var n=Pe,e=j,t=e("%TypeError%"),r=oe(),a=so(),s=lo();return Mn=function(l){if(r(l)!=="Object")throw new t("ToPropertyDescriptor requires an object");var c={};if(n(l,"enumerable")&&(c["[[Enumerable]]"]=a(l.enumerable)),n(l,"configurable")&&(c["[[Configurable]]"]=a(l.configurable)),n(l,"value")&&(c["[[Value]]"]=l.value),n(l,"writable")&&(c["[[Writable]]"]=a(l.writable)),n(l,"get")){var h=l.get;if(typeof h<"u"&&!s(h))throw new t("getter must be a function");c["[[Get]]"]=h}if(n(l,"set")){var g=l.set;if(typeof g<"u"&&!s(g))throw new t("setter must be a function");c["[[Set]]"]=g}if((n(c,"[[Get]]")||n(c,"[[Set]]"))&&(n(c,"[[Value]]")||n(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},Mn}var Gn,ts;function pu(){if(ts)return Gn;ts=1;var n=j,e=n("%TypeError%"),t=lu(),r=ro(),a=no(),s=du(),o=io(),l=et(),c=ao(),h=uo(),g=oe();return Gn=function(_,m,x){if(g(_)!=="Object")throw new e("Assertion failed: Type(O) is not Object");if(!l(m))throw new e("Assertion failed: IsPropertyKey(P) is not true");var B=t({Type:g,IsDataDescriptor:o,IsAccessorDescriptor:s},x)?x:h(x);if(!t({Type:g,IsDataDescriptor:o,IsAccessorDescriptor:s},B))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return r(o,c,a,_,m,B)},Gn}var rs;function hu(){if(rs)return Ht.exports;rs=1;var n=ou(),e=n("%Reflect.construct%",!0),t=pu();try{t({},"",{"[[Get]]":function(){}})}catch{t=null}if(t&&e){var r={},a={};t(a,"length",{"[[Get]]":function(){throw r},"[[Enumerable]]":!0}),Ht.exports=function(o){try{e(o,a)}catch(l){return l===r}}}else Ht.exports=function(o){return typeof o=="function"&&!!o.prototype};return Ht.exports}var Ln,ns;function fu(){if(ns)return Ln;ns=1;var n=j,e=n("%Symbol.species%",!0),t=n("%TypeError%"),r=ru(),a=eo(),s=Vi(),o=hu(),l=Zs(),c=oe();return Ln=function(g,v){if(!l(v)||v<0)throw new t("Assertion failed: length must be an integer >= 0");var _=s(g);if(!_)return r(v);var m=a(g,"constructor");if(e&&c(m)==="Object"&&(m=a(m,e),m===null&&(m=void 0)),typeof m>"u")return r(v);if(!o(m))throw new t("C must be a constructor");return new m(v)},Ln}var Vn,is;function yu(){if(is)return Vn;is=1;var n=j,e=ue(),t=n("%TypeError%"),r=Vi(),a=n("%Reflect.apply%",!0)||e("%Function.prototype.apply%");return Vn=function(o,l){var c=arguments.length>2?arguments[2]:[];if(!r(c))throw new t("Assertion failed: optional `argumentsList`, if provided, must be a List");return a(o,l,c)},Vn}var Wn,as;function gu(){if(as)return Wn;as=1;var n=j,e=n("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return Wn=e,Wn}var zn,ss;function mu(){if(ss)return zn;ss=1;var n=ue(),e=Fr()(),t,r,a,s;if(e){t=n("Object.prototype.hasOwnProperty"),r=n("RegExp.prototype.exec"),a={};var o=function(){throw a};s={toString:o,valueOf:o},typeof Symbol.toPrimitive=="symbol"&&(s[Symbol.toPrimitive]=o)}var l=n("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor,h="[object RegExp]";return zn=e?function(v){if(!v||typeof v!="object")return!1;var _=c(v,"lastIndex"),m=_&&t(_,"value");if(!m)return!1;try{r(v,s)}catch(x){return x===a}}:function(v){return!v||typeof v!="object"&&typeof v!="function"?!1:l(v)===h},zn}var Kn,os;function _u(){if(os)return Kn;os=1;var n=j,e=n("%Symbol.match%",!0),t=mu(),r=so();return Kn=function(s){if(!s||typeof s!="object")return!1;if(e){var o=s[e];if(typeof o<"u")return r(o)}return t(s)},Kn}var Jn,ls;function vu(){if(ls)return Jn;ls=1;var n=j,e=gu(),t=n("%TypeError%"),r=ue(),a=r("Object.prototype.propertyIsEnumerable"),s=Pe,o=Vi(),l=et(),c=_u(),h=uo(),g=oe();return Jn=function(_,m){if(g(_)!=="Object")throw new t("Assertion failed: O must be an Object");if(!l(m))throw new t("Assertion failed: P must be a Property Key");if(!!s(_,m)){if(!e){var x=o(_)&&m==="length",B=c(_)&&m==="lastIndex";return{"[[Configurable]]":!(x||B),"[[Enumerable]]":a(_,m),"[[Value]]":_[m],"[[Writable]]":!0}}return h(e(_,m))}},Jn}var Qn,us;function co(){return us||(us=1,Qn=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),Qn}var Yn,cs;function bu(){if(cs)return Yn;cs=1;var n=j,e=n("%Object.preventExtensions%",!0),t=n("%Object.isExtensible%",!0),r=co();return Yn=e?function(s){return!r(s)&&t(s)}:function(s){return!r(s)},Yn}var Xn,ds;function wu(){if(ds)return Xn;ds=1;var n=j,e=n("%TypeError%"),t=ro(),r=no(),a=vu(),s=io(),o=bu(),l=et(),c=ao(),h=oe();return Xn=function(v,_,m){if(h(v)!=="Object")throw new e("Assertion failed: Type(O) is not Object");if(!l(_))throw new e("Assertion failed: IsPropertyKey(P) is not true");var x=a(v,_),B=!x||o(v),T=x&&!x["[[Configurable]]"];return T||!B?!1:t(s,c,r,v,_,{"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":m,"[[Writable]]":!0})},Xn}var Zn,ps;function xu(){if(ps)return Zn;ps=1;var n=j,e=n("%TypeError%"),t=wu(),r=et(),a=oe();return Zn=function(o,l,c){if(a(o)!=="Object")throw new e("Assertion failed: Type(O) is not Object");if(!r(l))throw new e("Assertion failed: IsPropertyKey(P) is not true");var h=t(o,l,c);if(!h)throw new e("unable to create data property");return h},Zn}var ei,hs;function Su(){if(hs)return ei;hs=1;var n=j,e=n("%TypeError%"),t=et(),r=oe();return ei=function(s,o){if(r(s)!=="Object")throw new e("Assertion failed: `O` must be an Object");if(!t(o))throw new e("Assertion failed: `P` must be a Property Key");return o in s},ei}var ti,fs;function Au(){if(fs)return ti;fs=1;var n=ue(),e=n("RegExp.prototype.exec");return ti=function(r){return function(s){return e(r,s)!==null}},ti}var ri,ys;function Iu(){return ys||(ys=1,ri=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),ri}var ni,gs;function Tu(){if(gs)return ni;gs=1;var n=Date.prototype.getDay,e=function(o){try{return n.call(o),!0}catch{return!1}},t=Object.prototype.toString,r="[object Date]",a=Fr()();return ni=function(o){return typeof o!="object"||o===null?!1:a?e(o):t.call(o)===r},ni}var Ut={exports:{}},ms;function Pu(){if(ms)return Ut.exports;ms=1;var n=Object.prototype.toString,e=Li();if(e){var t=Symbol.prototype.toString,r=/^Symbol\(.*\)$/,a=function(o){return typeof o.valueOf()!="symbol"?!1:r.test(t.call(o))};Ut.exports=function(o){if(typeof o=="symbol")return!0;if(n.call(o)!=="[object Symbol]")return!1;try{return a(o)}catch{return!1}}}else Ut.exports=function(o){return!1};return Ut.exports}var ii,_s;function Eu(){if(_s)return ii;_s=1;var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",e=Iu(),t=oo(),r=Tu(),a=Pu(),s=function(c,h){if(typeof c>"u"||c===null)throw new TypeError("Cannot call method on "+c);if(typeof h!="string"||h!=="number"&&h!=="string")throw new TypeError('hint must be "string" or "number"');var g=h==="string"?["toString","valueOf"]:["valueOf","toString"],v,_,m;for(m=0;m<g.length;++m)if(v=c[g[m]],t(v)&&(_=v.call(c),e(_)))return _;throw new TypeError("No default value")},o=function(c,h){var g=c[h];if(g!==null&&typeof g<"u"){if(!t(g))throw new TypeError(g+" returned for property "+h+" of object "+c+" is not a function");return g}};return ii=function(c){if(e(c))return c;var h="default";arguments.length>1&&(arguments[1]===String?h="string":arguments[1]===Number&&(h="number"));var g;if(n&&(Symbol.toPrimitive?g=o(c,Symbol.toPrimitive):a(c)&&(g=Symbol.prototype.valueOf)),typeof g<"u"){var v=g.call(c,h);if(e(v))return v;throw new TypeError("unable to convert exotic object to primitive")}return h==="default"&&(r(c)||a(c))&&(h="string"),s(c,h==="default"?"number":h)},ii}var ai,vs;function Ru(){if(vs)return ai;vs=1;var n=Eu();return ai=function(t){return arguments.length>1?n(t,arguments[1]):n(t)},ai}var si,bs;function Cu(){if(bs)return si;bs=1;var n=j,e=n("%TypeError%"),t=n("%Number%"),r=n("%RegExp%"),a=n("%parseInt%"),s=ue(),o=Au(),l=co(),c=s("String.prototype.slice"),h=o(/^0b[01]+$/i),g=o(/^0o[0-7]+$/i),v=o(/^[-+]0x[0-9a-f]+$/i),_=["\x85","\u200B","\uFFFE"].join(""),m=new r("["+_+"]","g"),x=o(m),B=[`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003`,"\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028","\u2029\uFEFF"].join(""),T=new RegExp("(^["+B+"]+)|(["+B+"]+$)","g"),D=s("String.prototype.replace"),k=function(H){return D(H,T,"")},N=Ru();return si=function H(Q){var M=l(Q)?Q:N(Q,t);if(typeof M=="symbol")throw new e("Cannot convert a Symbol value to a number");if(typeof M=="bigint")throw new e("Conversion from 'BigInt' to 'number' is not allowed.");if(typeof M=="string"){if(h(M))return H(a(c(M,2),2));if(g(M))return H(a(c(M,2),8));if(x(M)||v(M))return NaN;var ie=k(M);if(ie!==M)return H(ie)}return t(M)},si}var oi,ws;function Bu(){if(ws)return oi;ws=1;var n=Cu();return oi=function(t){return n(t)>>>0},oi}var li,xs;function qu(){if(xs)return li;xs=1;var n=j,e=n("%Object%"),t=Ys();return li=function(a){return t(a),e(a)},li}var ui,Ss;function Ou(){if(Ss)return ui;Ss=1;var n=j,e=n("%String%"),t=n("%TypeError%");return ui=function(a){if(typeof a=="symbol")throw new t("Cannot convert a Symbol value to a string");return e(a)},ui}var ci,As;function po(){if(As)return ci;As=1;var n=fu(),e=yu(),t=xu(),r=eo(),a=Su(),s=lo(),o=Bu(),l=qu(),c=Ou(),h=ue(),g=Qs(),v=Object("a"),_=v[0]!=="a"||!(0 in v),m=h("String.prototype.split");return ci=function(B){var T=l(this),D=_&&g(T)?m(T,""):T,k=o(D.length);if(!s(B))throw new TypeError("Array.prototype.map callback must be a function");var N;arguments.length>1&&(N=arguments[1]);for(var H=n(T,k),Q=0;Q<k;){var M=c(Q),ie=a(T,M);if(ie){var q=r(T,M),P=e(B,N,[q,Q,T]);t(H,M,P)}Q+=1}return H},ci}var di,Is;function Du(){return Is||(Is=1,di=function(e){var t=!0,r=!0,a=!1;if(typeof e=="function"){try{e.call("f",function(s,o,l){typeof l!="object"&&(t=!1)}),e.call([null],function(){"use strict";r=typeof this=="string"},"x")}catch{a=!0}return!a&&t&&r}return!1}),di}var pi,Ts;function ho(){if(Ts)return pi;Ts=1;var n=Du(),e=po();return pi=function(){var r=Array.prototype.map;return n(r)?r:e},pi}var hi,Ps;function Hu(){if(Ps)return hi;Ps=1;var n=Hr,e=ho();return hi=function(){var r=e();return n(Array.prototype,{map:r},{map:function(){return Array.prototype.map!==r}}),r},hi}var fi,Es;function Uu(){if(Es)return fi;Es=1;var n=Hr,e=Ys(),t=ue(),r=po(),a=ho(),s=a(),o=Hu(),l=t("Array.prototype.slice"),c=function(g,v){return e(g),s.apply(g,l(arguments,1))};return n(c,{getPolyfill:a,implementation:r,shim:o}),fi=c,fi}var Fu=Ur;Fu();var Nu=Gl(),$u=Ll(),ju=Yl(),ku=Uu(),fo=j,yo=Ct.exports,Mu=yo(fo("%Promise.all%")),Gu=yo(fo("%Promise.reject%")),go=function(e){var t=this;if($u(t)!=="Object")throw new TypeError("`this` value must be an object");var r=ju(e);return Mu(t,ku(r,function(a){var s=function(c){return{status:"fulfilled",value:c}},o=function(c){return{status:"rejected",reason:c}},l=Nu(t,a);try{return l.then(s,o)}catch(c){return Gu(t,c)}}))},Lu=Ur,Vu=go,mo=function(){return Lu(),typeof Promise.allSettled=="function"?Promise.allSettled:Vu},Wu=Ur,zu=mo,Ku=Hr,Ju=function(){Wu();var e=zu();return Ku(Promise,{allSettled:e},{allSettled:function(){return Promise.allSettled!==e}}),e};(function(n){var e=Ct.exports,t=Hr,r=Ur,a=go,s=mo,o=Ju;r();var l=e(s()),c=function(g){return l(typeof this>"u"?Promise:this,g)};t(c,{getPolyfill:s,implementation:a,shim:o}),n.exports=c,n.exports.default=c})(Ms);const Qu=Ms.exports;var Rs=function(n){Pt(e,n);function e(t){var r=n.call(this,"Need to retry after "+t+" ms")||this;return r._retryAt=Date.now()+t,r}return Object.defineProperty(e.prototype,"retryAt",{get:function(){return this._retryAt},enumerable:!1,configurable:!0}),e}(js),Yu=function(){function n(e){var t=e.logger;this._queue=[],this._batchRunning=!1,this._logger=ki(Lt({name:"rate-limiter",emoji:!0},t))}return n.prototype.request=function(e,t){return Le(this,void 0,Promise,function(){var r=this;return Ve(this,function(a){return this._logger.trace("request start"),[2,new Promise(function(s,o){var l,c={req:e,resolve:s,reject:o,limitReachedBehavior:(l=t==null?void 0:t.limitReachedBehavior)!==null&&l!==void 0?l:"enqueue"};r._batchRunning||r._nextBatchTimer?(r._logger.trace("request queued batchRunning:"+r._batchRunning.toString()+" hasNextBatchTimer:"+(!!r._nextBatchTimer).toString()),r._queue.push(c)):r._runRequestBatch([c])})]})})},Object.defineProperty(n.prototype,"lastKnownLimit",{get:function(){var e,t;return(t=(e=this._parameters)===null||e===void 0?void 0:e.limit)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastKnownRemainingRequests",{get:function(){var e,t;return(t=(e=this._parameters)===null||e===void 0?void 0:e.remaining)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastKnownResetDate",{get:function(){var e;return Ue((e=this._parameters)===null||e===void 0?void 0:e.resetsAt,function(t){return new Date(t)})},enumerable:!1,configurable:!0}),n.prototype._runRequestBatch=function(e){return Le(this,void 0,void 0,function(){var t,r,a,s,o,l,c,h,g=this;return Ve(this,function(v){switch(v.label){case 0:return this._logger.trace("runRequestBatch start specs:"+e.length),this._batchRunning=!0,this._parameters&&this._logger.debug("Remaining requests: "+this._parameters.remaining),this._logger.debug("Doing "+e.length+" requests, new queue length is "+this._queue.length),t=e.map(function(_){return Le(g,void 0,Promise,function(){var m,x,B,T,D,k,N;return Ve(this,function(H){switch(H.label){case 0:m=_.req,x=_.resolve,B=_.reject,H.label=1;case 1:return H.trys.push([1,3,,4]),[4,this.doRequest(m)];case 2:if(T=H.sent(),D=this.needsToRetryAfter(T),D!==null)throw this._queue.unshift(_),this._logger.info("Retrying after "+D+" ms"),new Rs(D);return k=this.getParametersFromResponse(T),x(T),[2,k];case 3:if(N=H.sent(),N instanceof Rs)throw N;return B(N),[2,void 0];case 4:return[2]}})})}),[4,Qu.call(Promise,t)];case 1:return r=v.sent(),a=r.filter(function(_){return _.status==="rejected"}),s=Date.now(),a.length?(this._logger.trace("runRequestBatch some rejected"),o=Math.max.apply(Math,Et([s],a.map(function(_){return _.reason.retryAt}))),l=o-s,this._logger.warn("Waiting for "+l+" ms because the rate limit was exceeded"),this._nextBatchTimer=setTimeout(function(){g._parameters=void 0,g._runNextBatch()},l)):(this._logger.trace("runRequestBatch none rejected"),c=r.filter(function(_){return _.status==="fulfilled"&&_.value!==void 0}).map(function(_){return _.value}).reduce(function(_,m){return _?m.remaining<_.remaining?m:_:m},void 0),this._batchRunning=!1,c&&(this._parameters=c,c.resetsAt<s||c.remaining>0?(this._logger.trace("runRequestBatch canRunMore"),this._runNextBatch()):(h=c.resetsAt-s,this._logger.trace("runRequestBatch delay:"+h),this._logger.warn("Waiting for "+h+" ms because the rate limit was reached"),this._queue=this._queue.filter(function(_){switch(_.limitReachedBehavior){case"enqueue":return!0;case"null":return _.resolve(null),!1;case"throw":return _.reject(new ks("Request removed from queue because the rate limit was reached")),!1;default:throw new Error("this should never happen")}}),this._nextBatchTimer=setTimeout(function(){g._parameters=void 0,g._runNextBatch()},h)))),this._logger.trace("runRequestBatch end"),[2]}})})},n.prototype._runNextBatch=function(){return Le(this,void 0,void 0,function(){var e,t;return Ve(this,function(r){return this._logger.trace("runNextBatch start"),this._nextBatchTimer&&(clearTimeout(this._nextBatchTimer),this._nextBatchTimer=void 0),e=this._parameters?Math.min(this._parameters.remaining,this._parameters.limit/10):1,t=this._queue.splice(0,e),t.length&&this._runRequestBatch(t),this._logger.trace("runNextBatch end"),[2]})})},n}(),Xu=function(){function n(e){var t=e.logger,r=e.bucketSize,a=e.timeFrame,s=e.doRequest;this._queue=[],this._usedFromBucket=0,this._logger=ki(Lt({name:"rate-limiter",emoji:!0},t)),this._bucketSize=r,this._timeFrame=a,this._callback=s}return n.prototype.request=function(e,t){return Le(this,void 0,Promise,function(){var r=this;return Ve(this,function(a){return[2,new Promise(function(s,o){var l,c={req:e,resolve:s,reject:o,limitReachedBehavior:(l=t==null?void 0:t.limitReachedBehavior)!==null&&l!==void 0?l:"enqueue"};if(r._usedFromBucket>=r._bucketSize)switch(c.limitReachedBehavior){case"enqueue":{r._queue.push(c),r._logger.warn("Rate limit of "+r._bucketSize+" was reached, waiting for a free bucket entry; queue size is "+r._queue.length);break}case"null":{c.resolve(null),r._logger.warn("Rate limit of "+r._bucketSize+" was reached, dropping request and returning null");break}case"throw":{c.reject(new ks("Request dropped because the rate limit was reached"));break}default:throw new Error("this should never happen")}else r._runRequest(c)})]})})},n.prototype._runRequest=function(e){return Le(this,void 0,void 0,function(){var t,r,a,s,o,l=this;return Ve(this,function(c){switch(c.label){case 0:this._logger.debug("doing a request, new queue length is "+this._queue.length),this._usedFromBucket+=1,t=e.req,r=e.resolve,a=e.reject,c.label=1;case 1:return c.trys.push([1,3,4,5]),s=r,[4,this._callback(t)];case 2:return s.apply(void 0,[c.sent()]),[3,5];case 3:return o=c.sent(),a(o),[3,5];case 4:return setTimeout(function(){l._usedFromBucket-=1,l._queue.length&&l._usedFromBucket<l._bucketSize&&l._runNextRequest()},this._timeFrame),[7];case 5:return[2]}})})},n.prototype._runNextRequest=function(){var e=this._queue.shift();e&&this._runRequest(e)},n}(),lt={exports:{}};(function(n,e){var t=typeof self<"u"?self:Ko,r=function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s}();(function(s){(function(o){var l={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function c(f){return f&&DataView.prototype.isPrototypeOf(f)}if(l.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=ArrayBuffer.isView||function(f){return f&&h.indexOf(Object.prototype.toString.call(f))>-1};function v(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function _(f){return typeof f!="string"&&(f=String(f)),f}function m(f){var b={next:function(){var E=f.shift();return{done:E===void 0,value:E}}};return l.iterable&&(b[Symbol.iterator]=function(){return b}),b}function x(f){this.map={},f instanceof x?f.forEach(function(b,E){this.append(E,b)},this):Array.isArray(f)?f.forEach(function(b){this.append(b[0],b[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(b){this.append(b,f[b])},this)}x.prototype.append=function(f,b){f=v(f),b=_(b);var E=this.map[f];this.map[f]=E?E+", "+b:b},x.prototype.delete=function(f){delete this.map[v(f)]},x.prototype.get=function(f){return f=v(f),this.has(f)?this.map[f]:null},x.prototype.has=function(f){return this.map.hasOwnProperty(v(f))},x.prototype.set=function(f,b){this.map[v(f)]=_(b)},x.prototype.forEach=function(f,b){for(var E in this.map)this.map.hasOwnProperty(E)&&f.call(b,this.map[E],E,this)},x.prototype.keys=function(){var f=[];return this.forEach(function(b,E){f.push(E)}),m(f)},x.prototype.values=function(){var f=[];return this.forEach(function(b){f.push(b)}),m(f)},x.prototype.entries=function(){var f=[];return this.forEach(function(b,E){f.push([E,b])}),m(f)},l.iterable&&(x.prototype[Symbol.iterator]=x.prototype.entries);function B(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function T(f){return new Promise(function(b,E){f.onload=function(){b(f.result)},f.onerror=function(){E(f.error)}})}function D(f){var b=new FileReader,E=T(b);return b.readAsArrayBuffer(f),E}function k(f){var b=new FileReader,E=T(b);return b.readAsText(f),E}function N(f){for(var b=new Uint8Array(f),E=new Array(b.length),ee=0;ee<b.length;ee++)E[ee]=String.fromCharCode(b[ee]);return E.join("")}function H(f){if(f.slice)return f.slice(0);var b=new Uint8Array(f.byteLength);return b.set(new Uint8Array(f)),b.buffer}function Q(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:l.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:l.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():l.arrayBuffer&&l.blob&&c(f)?(this._bodyArrayBuffer=H(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||g(f))?this._bodyArrayBuffer=H(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var f=B(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?B(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(D)}),this.text=function(){var f=B(this);if(f)return f;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var M=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function ie(f){var b=f.toUpperCase();return M.indexOf(b)>-1?b:f}function q(f,b){b=b||{};var E=b.body;if(f instanceof q){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,b.headers||(this.headers=new x(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!E&&f._bodyInit!=null&&(E=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new x(b.headers)),this.method=ie(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&E)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(E)}q.prototype.clone=function(){return new q(this,{body:this._bodyInit})};function P(f){var b=new FormData;return f.trim().split("&").forEach(function(E){if(E){var ee=E.split("="),X=ee.shift().replace(/\+/g," "),U=ee.join("=").replace(/\+/g," ");b.append(decodeURIComponent(X),decodeURIComponent(U))}}),b}function J(f){var b=new x,E=f.replace(/\r?\n[\t ]+/g," ");return E.split(/\r?\n/).forEach(function(ee){var X=ee.split(":"),U=X.shift().trim();if(U){var Ee=X.join(":").trim();b.append(U,Ee)}}),b}Q.call(q.prototype);function W(f,b){b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new x(b.headers),this.url=b.url||"",this._initBody(f)}Q.call(W.prototype),W.prototype.clone=function(){return new W(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new x(this.headers),url:this.url})},W.error=function(){var f=new W(null,{status:0,statusText:""});return f.type="error",f};var re=[301,302,303,307,308];W.redirect=function(f,b){if(re.indexOf(b)===-1)throw new RangeError("Invalid status code");return new W(null,{status:b,headers:{location:f}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,E){this.message=b,this.name=E;var ee=Error(b);this.stack=ee.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function Z(f,b){return new Promise(function(E,ee){var X=new q(f,b);if(X.signal&&X.signal.aborted)return ee(new o.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function Ee(){U.abort()}U.onload=function(){var pe={status:U.status,statusText:U.statusText,headers:J(U.getAllResponseHeaders()||"")};pe.url="responseURL"in U?U.responseURL:pe.headers.get("X-Request-URL");var Ne="response"in U?U.response:U.responseText;E(new W(Ne,pe))},U.onerror=function(){ee(new TypeError("Network request failed"))},U.ontimeout=function(){ee(new TypeError("Network request failed"))},U.onabort=function(){ee(new o.DOMException("Aborted","AbortError"))},U.open(X.method,X.url,!0),X.credentials==="include"?U.withCredentials=!0:X.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&l.blob&&(U.responseType="blob"),X.headers.forEach(function(pe,Ne){U.setRequestHeader(Ne,pe)}),X.signal&&(X.signal.addEventListener("abort",Ee),U.onreadystatechange=function(){U.readyState===4&&X.signal.removeEventListener("abort",Ee)}),U.send(typeof X._bodyInit>"u"?null:X._bodyInit)})}return Z.polyfill=!0,s.fetch||(s.fetch=Z,s.Headers=x,s.Request=q,s.Response=W),o.Headers=x,o.Request=q,o.Response=W,o.fetch=Z,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var a=r;e=a.fetch,e.default=a.fetch,e.fetch=a.fetch,e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response,n.exports=e})(lt,lt.exports);const _o=Jo(lt.exports);var yi=Object.prototype.hasOwnProperty,Ge=Array.isArray,ce=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),Zu=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(Ge(r)){for(var a=[],s=0;s<r.length;++s)typeof r[s]<"u"&&a.push(r[s]);t.obj[t.prop]=a}}},vo=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},a=0;a<e.length;++a)typeof e[a]<"u"&&(r[a]=e[a]);return r},ec=function n(e,t,r){if(!t)return e;if(typeof t!="object"){if(Ge(e))e.push(t);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!yi.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var a=e;return Ge(e)&&!Ge(t)&&(a=vo(e,r)),Ge(e)&&Ge(t)?(t.forEach(function(s,o){if(yi.call(e,o)){var l=e[o];l&&typeof l=="object"&&s&&typeof s=="object"?e[o]=n(l,s,r):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var l=t[o];return yi.call(s,o)?s[o]=n(s[o],l,r):s[o]=l,s},a)},tc=function(e,t){return Object.keys(t).reduce(function(r,a){return r[a]=t[a],r},e)},rc=function(n,e,t){var r=n.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},nc=function(e,t,r){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),r==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var s="",o=0;o<a.length;++o){var l=a.charCodeAt(o);if(l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122){s+=a.charAt(o);continue}if(l<128){s=s+ce[l];continue}if(l<2048){s=s+(ce[192|l>>6]+ce[128|l&63]);continue}if(l<55296||l>=57344){s=s+(ce[224|l>>12]+ce[128|l>>6&63]+ce[128|l&63]);continue}o+=1,l=65536+((l&1023)<<10|a.charCodeAt(o)&1023),s+=ce[240|l>>18]+ce[128|l>>12&63]+ce[128|l>>6&63]+ce[128|l&63]}return s},ic=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],a=0;a<t.length;++a)for(var s=t[a],o=s.obj[s.prop],l=Object.keys(o),c=0;c<l.length;++c){var h=l[c],g=o[h];typeof g=="object"&&g!==null&&r.indexOf(g)===-1&&(t.push({obj:o,prop:h}),r.push(g))}return Zu(t),e},ac=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},sc=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},oc=function(e,t){return[].concat(e,t)},bo={arrayToObject:vo,assign:tc,combine:oc,compact:ic,decode:rc,encode:nc,isBuffer:sc,isRegExp:ac,merge:ec},lc=String.prototype.replace,uc=/%20/g,cc=bo,Cs={RFC1738:"RFC1738",RFC3986:"RFC3986"},dc=cc.assign({default:Cs.RFC3986,formatters:{RFC1738:function(n){return lc.call(n,uc,"+")},RFC3986:function(n){return String(n)}}},Cs),wo=bo,at=dc,pc=Object.prototype.hasOwnProperty,Bs={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Je=Array.isArray,hc=Array.prototype.push,wi=function(n,e){hc.apply(n,Je(e)?e:[e])},fc=Date.prototype.toISOString,qs=at.default,ne={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:wo.encode,encodeValuesOnly:!1,format:qs,formatter:at.formatters[qs],indices:!1,serializeDate:function(e){return fc.call(e)},skipNulls:!1,strictNullHandling:!1},yc=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},gc=function n(e,t,r,a,s,o,l,c,h,g,v,_,m){var x=e;if(typeof l=="function"?x=l(t,x):x instanceof Date?x=g(x):r==="comma"&&Je(x)&&(x=x.join(",")),x===null){if(a)return o&&!_?o(t,ne.encoder,m,"key"):t;x=""}if(yc(x)||wo.isBuffer(x)){if(o){var B=_?t:o(t,ne.encoder,m,"key");return[v(B)+"="+v(o(x,ne.encoder,m,"value"))]}return[v(t)+"="+v(String(x))]}var T=[];if(typeof x>"u")return T;var D;if(Je(l))D=l;else{var k=Object.keys(x);D=c?k.sort(c):k}for(var N=0;N<D.length;++N){var H=D[N];s&&x[H]===null||(Je(x)?wi(T,n(x[H],typeof r=="function"?r(t,H):t,r,a,s,o,l,c,h,g,v,_,m)):wi(T,n(x[H],t+(h?"."+H:"["+H+"]"),r,a,s,o,l,c,h,g,v,_,m)))}return T},mc=function(e){if(!e)return ne;if(e.encoder!==null&&e.encoder!==void 0&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||ne.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=at.default;if(typeof e.format<"u"){if(!pc.call(at.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var a=at.formatters[r],s=ne.filter;return(typeof e.filter=="function"||Je(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:ne.addQueryPrefix,allowDots:typeof e.allowDots>"u"?ne.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ne.charsetSentinel,delimiter:typeof e.delimiter>"u"?ne.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:ne.encode,encoder:typeof e.encoder=="function"?e.encoder:ne.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:ne.encodeValuesOnly,filter:s,formatter:a,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:ne.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:ne.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ne.strictNullHandling}},Nr=function(n,e){var t=n,r=mc(e),a,s;typeof r.filter=="function"?(s=r.filter,t=s("",t)):Je(r.filter)&&(s=r.filter,a=s);var o=[];if(typeof t!="object"||t===null)return"";var l;e&&e.arrayFormat in Bs?l=e.arrayFormat:e&&"indices"in e?l=e.indices?"indices":"repeat":l="indices";var c=Bs[l];a||(a=Object.keys(t)),r.sort&&a.sort(r.sort);for(var h=0;h<a.length;++h){var g=a[h];r.skipNulls&&t[g]===null||wi(o,gc(t[g],g,c,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.formatter,r.encodeValuesOnly,r.charset))}var v=o.join(r.delimiter),_=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),v.length>0?_+v:""};const i=Symbol("twurpleRawData");class S{constructor(e){this[i]=e}}function w(n,e,t){return r=>{const a=t?function(){return`[${e}#${this[t]} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`};Object.defineProperty(r.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:a,enumerable:!1})}}class _c extends S{parseMessage(e,t){const r=[],a=this.getPossibleNames(),s=new RegExp("(?<=^|\\s)([a-z0-9]+?)(\\d+)(?=\\s|$)","gi");let o=null;for(;o=s.exec(e);){const l=o[1].toLowerCase();if(a.includes(l)){const c=Number(o[2]);r.push({name:l,amount:c,position:al(e.slice(0,o.index)),length:o[0].length,displayInfo:this.getCheermoteDisplayInfo(l,c,t)})}}return r}transformCheerMessage(e,t,r){const a=[];let s=0;for(const o of this.parseMessage(e,t))s<o.position&&a.push(e.substring(s,o.position)),a.push(r(o)),s=o.position+o.length;return s<e.length&&a.push(e.slice(s)),a}}let xi=class extends S{get authorName(){return this[i].author_name}get bitsEnabled(){return this[i].bits_enabled}get installable(){return this[i].can_install}get configurationLocation(){return this[i].configuration_location}get description(){return this[i].description}get tosUrl(){return this[i].eula_tos_url}get hasChatSupport(){return this[i].has_chat_support}get iconUrl(){return this[i].icon_url}getIconUrl(e){return this[i].icon_urls[e]}get id(){return this[i].id}get name(){return this[i].name}get privacyPolicyUrl(){return this[i].privacy_policy_url}get requestsIdentityLink(){return this[i].request_identity_link}get screenshotUrls(){return this[i].screenshot_urls}get state(){return this[i].state}get subscriptionsSupportLevel(){return this[i].subscriptions_support_level}get summary(){return this[i].summary}get supportEmail(){return this[i].support_email}get version(){return this[i].version}get viewerSummery(){return this[i].viewer_summary}get allowedConfigUrls(){return this[i].allowlisted_config_urls}get allowedPanelUrls(){return this[i].allowlisted_panel_urls}get mobileViewerUrl(){var e,t;return(t=(e=this[i].views.mobile)===null||e===void 0?void 0:e.viewer_url)!==null&&t!==void 0?t:null}get panelViewerUrl(){var e,t;return(t=(e=this[i].views.panel)===null||e===void 0?void 0:e.viewer_url)!==null&&t!==void 0?t:null}get panelHeight(){var e,t;return(t=(e=this[i].views.panel)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:null}get panelCanLinkExternalContent(){var e,t;return(t=(e=this[i].views.panel)===null||e===void 0?void 0:e.can_link_external_content)!==null&&t!==void 0?t:null}get overlayViewerUrl(){var e,t;return(t=(e=this[i].views.video_overlay)===null||e===void 0?void 0:e.viewer_url)!==null&&t!==void 0?t:null}get overlayCanLinkExternalContent(){var e,t;return(t=(e=this[i].views.video_overlay)===null||e===void 0?void 0:e.can_link_external_content)!==null&&t!==void 0?t:null}get componentViewerUrl(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.viewer_url)!==null&&t!==void 0?t:null}get componentAspectWidth(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.aspect_width)!==null&&t!==void 0?t:null}get componentAspectHeight(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.aspect_height)!==null&&t!==void 0?t:null}get componentAspectRatioX(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.aspect_ratio_x)!==null&&t!==void 0?t:null}get componentAspectRatioY(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.aspect_ratio_y)!==null&&t!==void 0?t:null}get componentAutoScales(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.autoscale)!==null&&t!==void 0?t:null}get componentScalePixels(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.scale_pixels)!==null&&t!==void 0?t:null}get componentTargetHeight(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.target_height)!==null&&t!==void 0?t:null}get componentSize(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.size)!==null&&t!==void 0?t:null}get componentZoom(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.zoom)!==null&&t!==void 0?t:null}get componentZoomPixels(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.zoom_pixels)!==null&&t!==void 0?t:null}get componentCanLinkExternalContent(){var e,t;return(t=(e=this[i].views.component)===null||e===void 0?void 0:e.can_link_external_content)!==null&&t!==void 0?t:null}get configViewerUrl(){var e,t;return(t=(e=this[i].views.config)===null||e===void 0?void 0:e.viewer_url)!==null&&t!==void 0?t:null}get configCanLinkExternalContent(){var e,t;return(t=(e=this[i].views.config)===null||e===void 0?void 0:e.can_link_external_content)!==null&&t!==void 0?t:null}};xi=u([w("api","HelixExtension","id")],xi);class Fe extends Error{constructor(e,t){var r;super(e,t),Object.setPrototypeOf(this,new.target.prototype),(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}class Kt extends Fe{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function d(n){return typeof n=="string"?n:typeof n=="number"?n.toString(10):n.id}function Jt(n){return typeof n=="string"?n:n.name}class Xe extends Fe{constructor(e,t,r,a,s,o){super(`Encountered HTTP status code ${e}: ${t}

URL: ${r}
Method: ${a}
Body:
${!o&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=r,this._method=a,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function xo(n,e){var t;if(!n.ok){const r=n.headers.get("Content-Type")==="application/json",a=r?JSON.stringify(await n.json(),null,2):await n.text(),s=Nr(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),o=`${e.url}${s}`;throw new Xe(n.status,n.statusText,o,(t=e.method)!==null&&t!==void 0?t:"GET",a,r)}}async function So(n){if(n.status===204)return;const e=await n.text();if(!!e)return JSON.parse(e)}function vc(n,e){switch(e){case"helix":return`https://api.twitch.tv/helix/${n.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${n.replace(/^\//,"")}`;case"custom":return n;default:return n}}async function Qt(n,e,t,r,a={}){var s,o;const l=(s=n.type)!==null&&s!==void 0?s:"helix",c=vc(n.url,l),h=Nr(n.query,{arrayFormat:"repeat",addQueryPrefix:!0}),g=new lt.exports.Headers({Accept:"application/json"});let v;n.jsonBody&&(v=JSON.stringify(n.jsonBody),g.append("Content-Type","application/json")),e&&l!=="auth"&&g.append("Client-ID",e),t&&g.append("Authorization",`${l==="helix"?r!=null?r:"Bearer":"OAuth"} ${t}`);const _={...a,method:(o=n.method)!==null&&o!==void 0?o:"GET",headers:g,body:v};return await _o(`${c}${h}`,_)}async function bc(n,e,t,r,a={}){const s=await Qt(n,e,t,r,a);return await xo(s,n),await So(s)}const wc=6e4;function xc(n){return Ue(n.expiresIn,e=>n.obtainmentTimestamp+e*1e3-wc)}function Ao(n){var e;return(e=Ue(xc(n),t=>Date.now()>t))!==null&&e!==void 0?e:!1}class Sc extends Fe{constructor(e,t,r,a,s,o){super(`Encountered HTTP status code ${e}: ${t}

URL: ${r}
Method: ${a}
Body:
${!o&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=r,this._method=a,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function Ac(n,e){var t;if(!n.ok){const r=n.headers.get("Content-Type")==="application/json",a=r?JSON.stringify(await n.json(),null,2):await n.text(),s=Nr(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),o=`${e.url}${s}`;throw new Sc(n.status,n.statusText,o,(t=e.method)!==null&&t!==void 0?t:"GET",a,r)}}async function Ic(n){if(n.status===204)return;const e=await n.text();if(!!e)return JSON.parse(e)}function Tc(n,e){switch(e){case"helix":return`https://api.twitch.tv/helix/${n.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${n.replace(/^\//,"")}`;case"custom":return n;default:return n}}async function Pc(n,e,t,r,a={}){var s,o;const l=(s=n.type)!==null&&s!==void 0?s:"helix",c=Tc(n.url,l),h=Nr(n.query,{arrayFormat:"repeat",addQueryPrefix:!0}),g=new lt.exports.Headers({Accept:"application/json"});let v;n.jsonBody&&(v=JSON.stringify(n.jsonBody),g.append("Content-Type","application/json")),e&&l!=="auth"&&g.append("Client-ID",e),t&&g.append("Authorization",`${l==="helix"?r!=null?r:"Bearer":"OAuth"} ${t}`);const _={...a,method:(o=n.method)!==null&&o!==void 0?o:"GET",headers:g,body:v};return await _o(`${c}${h}`,_)}async function Ec(n,e,t,r,a={}){const s=await Pc(n,e,t,r,a);return await Ac(s,n),await Ic(s)}class Rc extends Fe{constructor(e){super("Invalid token supplied",e)}}let Si=class extends S{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[i].client_id}get userId(){var e;return(e=this[i].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[i].login)!==null&&e!==void 0?e:null}get scopes(){return this[i].scopes}get expiryDate(){return Ue(this[i].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};Si=u([w("auth","TokenInfo","clientId")],Si);function Cc(n){var e,t;return{accessToken:n.access_token,refreshToken:n.refresh_token||null,scope:(e=n.scope)!==null&&e!==void 0?e:[],expiresIn:(t=n.expires_in)!==null&&t!==void 0?t:null,obtainmentTimestamp:Date.now()}}async function Bc(n,e){return Cc(await Ec({type:"auth",url:"token",method:"POST",query:{grant_type:"client_credentials",client_id:n,client_secret:e}}))}class qc{constructor(){this._newTokenScopes=new Set,this._newTokenPromise=null,this._queuedScopes=new Set,this._queueExecutor=null,this._queuePromise=null}async getAccessToken(e){var t;if(this._newTokenPromise){if(!e||e.every(r=>this._newTokenScopes.has(r)))return await this._newTokenPromise;if(this._queueExecutor)for(const r of e)this._queuedScopes.add(r);else this._queuedScopes=new Set(e);return(t=this._queuePromise)!==null&&t!==void 0||(this._queuePromise=new Promise((r,a)=>{this._queueExecutor=async()=>{var s;if(!!this._queuePromise){this._newTokenScopes=this._queuedScopes,this._queuedScopes=new Set,this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{r(await this._doGetAccessToken(Array.from(this._newTokenScopes)))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopes=new Set,(s=this._queueExecutor)===null||s===void 0||s.call(this)}}}})),await this._queuePromise}return this._newTokenScopes=new Set(e!=null?e:[]),this._newTokenPromise=new Promise(async(r,a)=>{var s;try{const o=Array.from(this._newTokenScopes);r(await this._doGetAccessToken(o))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopes=new Set,(s=this._queueExecutor)===null||s===void 0||s.call(this)}}),await this._newTokenPromise}}let ut=class extends qc{constructor(e,t,r=[]){super(),this.tokenType="app",this._clientId=e,this._clientSecret=t,this._impliedScopes=r}async refresh(){return this._token=await Bc(this._clientId,this._clientSecret)}get clientId(){return this._clientId}get currentScopes(){return[]}async _doGetAccessToken(e){if(e&&e.length>0)if(this._impliedScopes.length){if(e.some(t=>!this._impliedScopes.includes(t)))throw new Error(`Scope ${e.join(", ")} requested but only the scope ${this._impliedScopes.join(", ")} is implied`)}else throw new Error(`Scope ${e.join(", ")} requested but the client credentials flow does not support scopes`);return!this._token||Ao(this._token)?await this.refresh():this._token}};u([C(!1)],ut.prototype,"_clientSecret",void 0);u([C(!1)],ut.prototype,"_token",void 0);ut=u([w("auth","ClientCredentialsAuthProvider","clientId")],ut);class V{constructor(e){this._client=e}}u([C(!1)],V.prototype,"_client",void 0);let Ai=class extends S{get clickAction(){return this[i].click_action}get clickUrl(){return this[i].click_url}get description(){return this[i].description}getImageUrl(e){return this[i][`image_url_${e}x`]}get title(){return this[i].title}};Ai=u([w("api","ChatBadgeVersion")],Ai);let Ii=class extends S{get versionNames(){return Object.keys(this[i].versions)}getVersion(e){return new Ai(this[i].versions[e])}};Ii=u([w("api","ChatBadgeSet")],Ii);var $t;let Yt=$t=class extends S{get badgeSetNames(){return Object.keys(this[i])}getBadgeSet(e){return new Ii(this[i][e])}_merge(e){return e instanceof $t&&(e=e[i]),new $t({...this[i],...e})}};Yt=$t=u([w("api","ChatBadgeList")],Yt);let Ti=class extends V{async getGlobalBadges(e){const t=await this._client.callApi({url:"https://badges.twitch.tv/v1/badges/global/display",query:{language:e},type:"custom"});return new Yt(t.badge_sets)}async getChannelBadges(e,t=!0,r){const a=await this._client.callApi({url:`https://badges.twitch.tv/v1/badges/channels/${d(e)}/display`,query:{language:r},type:"custom"}),s=new Yt(a.badge_sets);return t?(await this.getGlobalBadges(r))._merge(s):s}};Ti=u([w("api","BadgesApi")],Ti);let Xt=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}get rank(){return this[i].rank}get amount(){return this[i].score}async getUser(){return await this._client.users.getUserById(this[i].user_id)}};u([C(!1)],Xt.prototype,"_client",void 0);Xt=u([w("api","HelixBitsLeaderboardEntry","userId")],Xt);let ct=class extends S{constructor(e,t){super(e),this._client=t}get entries(){return this[i].data.map(e=>new Xt(e,this._client))}get totalCount(){return this[i].total}};u([C(!1)],ct.prototype,"_client",void 0);u([I()],ct.prototype,"entries",null);ct=u([Rt,w("api","HelixBitsLeaderboard")],ct);let Pi=class extends _c{constructor(e){super(il(e,t=>t.prefix.toLowerCase()))}getCheermoteDisplayInfo(e,t,r){e=e.toLowerCase();const{background:a,state:s,scale:o}=r,c=this[i][e].tiers.sort((h,g)=>g.min_bits-h.min_bits).find(h=>h.min_bits<=t);if(!c)throw new Kt(`Cheermote "${e}" does not have an applicable tier for ${t} bits`);return{url:c.images[a][s][o],color:c.color}}getPossibleNames(){return Object.keys(this[i])}};Pi=u([w("api","HelixCheermoteList")],Pi);let Zt=class extends V{async getLeaderboard(e={}){const{count:t=10,period:r="all",startDate:a,contextUserId:s}=e,o=await this._client.callApi({type:"helix",url:"bits/leaderboard",scope:"bits:read",query:{count:t.toString(),period:r,started_at:a?a.toISOString():void 0,user_id:s}});return new ct(o,this._client)}async getCheermotes(e){const t=e?d(e):void 0,r=await this._client.callApi({type:"helix",url:"bits/cheermotes",query:{broadcaster_id:t}});return new Pi(r.data)}};Zt=u([w("api","HelixBitsApi")],Zt);var gi;Object.prototype.hasOwnProperty.call(Symbol,"asyncIterator")||(Symbol.asyncIterator=(gi=Symbol.asyncIterator)!==null&&gi!==void 0?gi:Symbol.for("Symbol.asyncIterator"));let z=class{constructor(e,t,r,a=100){this._callOptions=e,this._mapper=r,this._limitPerPage=a,this._isFinished=!1,this._client=t}get current(){var e;return(e=this._currentData)===null||e===void 0?void 0:e.data}async getNext(){var e;if(this._isFinished)return[];const t=await this._fetchData();return!((e=t.data)===null||e===void 0)&&e.length?this._processResult(t):(this._isFinished=!0,[])}async getAll(){this.reset();const e=[];do{const t=await this.getNext();if(!t.length)break;e.push(...t)}while(this._currentCursor);return this.reset(),e}get currentCursor(){return this._currentCursor}reset(){this._currentCursor=void 0,this._isFinished=!1,this._currentData=void 0}async*[Symbol.asyncIterator](){for(this.reset();;){const e=await this.getNext();if(!e.length)break;yield*e[Symbol.iterator]()}}async _fetchData(e={}){return await this._client.callApi({type:"helix",...this._callOptions,...e,query:{...this._callOptions.query,after:this._currentCursor,first:this._limitPerPage.toString(),...e.query}})}_processResult(e){return this._currentCursor=e.pagination?e.pagination.cursor:void 0,this._currentCursor===void 0&&(this._isFinished=!0),this._currentData=e,e.data.reduce((t,r)=>{const a=this._mapper(r);return Array.isArray(a)?[...t,...a]:[...t,a]},[])}};u([C(!1)],z.prototype,"_client",void 0);z=u([w("api","HelixPaginatedRequest")],z);function te(n,e,t){var r,a,s;return{data:(a=(r=n.data)===null||r===void 0?void 0:r.map(o=>new e(o,t)))!==null&&a!==void 0?a:[],cursor:(s=n.pagination)===null||s===void 0?void 0:s.cursor}}function We(n,e,t){return{data:n.data.map(r=>new e(r,t)),cursor:n.pagination.cursor,total:n.total}}function L({after:n,before:e,limit:t}={}){return{after:n,before:e,first:t==null?void 0:t.toString()}}let De=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].user_id}get name(){return this[i].user_login}get displayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}};u([C(!1)],De.prototype,"_client",void 0);De=u([w("api","HelixUserRelation","id")],De);let er=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].broadcaster_id}get name(){return this[i].broadcaster_login}get displayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get language(){return this[i].broadcaster_language}get gameId(){return this[i].game_id}get gameName(){return this[i].game_name}async getGame(){return await this._client.games.getGameById(this[i].game_id)}get title(){return this[i].title}get delay(){return this[i].delay}};u([C(!1)],er.prototype,"_client",void 0);er=u([w("api","HelixChannel","id")],er);let tr=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user_id}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get creationDate(){return new Date(this[i].created_at)}};u([C(!1)],tr.prototype,"_client",void 0);tr=u([w("api","HelixChannelEditor","userId")],tr);let rr=class extends V{async getChannelInfoById(e){var t;return(t=(await this.getChannelInfoByIds([e]))[0])!==null&&t!==void 0?t:null}async getChannelInfoByIds(e){const t=e.map(d);return(await this._client.callApi({type:"helix",url:"channels",query:{broadcaster_id:t}})).data.map(a=>new er(a,this._client))}async getChannelInfo(e){return await this.getChannelInfoById(e)}async updateChannelInfo(e,t){var r;const a=d(e);await this._client.callApi({type:"helix",url:"channels",method:"PATCH",scope:"channel:manage:broadcast",query:{broadcaster_id:a},jsonBody:{game_id:t.gameId,broadcaster_language:t.language,title:t.title,delay:(r=t.delay)===null||r===void 0?void 0:r.toString()}})}async startChannelCommercial(e,t){await this._client.callApi({type:"helix",url:"channels/commercial",method:"POST",scope:"channel:edit:commercial",jsonBody:{broadcaster_id:d(e),length:t}})}async getChannelEditors(e){return(await this._client.callApi({type:"helix",url:"channels/editors",scope:"channel:read:editors",query:{broadcaster_id:d(e)}})).data.map(r=>new tr(r,this._client))}async getVips(e,t){const r=await this._client.callApi({type:"helix",url:"channels/vips",scope:"channel:read:vips",query:{broadcaster_id:d(e),...L(t)}});return te(r,De,this._client)}getVipsPaginated(e){return new z({url:"channels/vips",scope:"channel:read:vips",query:{broadcaster_id:d(e)}},this._client,t=>new De(t,this._client))}async checkVipForUsers(e,t){return(await this._client.callApi({type:"helix",url:"channels/vips",scope:"channel:read:vips",query:{broadcaster_id:d(e),user_id:t.map(d)}})).data.map(a=>new De(a,this._client))}async checkVipForUser(e,t){const r=d(t);return(await this.checkVipForUsers(e,[r])).some(s=>s.id===r)}async addVip(e,t){await this._client.callApi({type:"helix",url:"channels/vips",method:"POST",scope:"channel:manage:vips",query:{broadcaster_id:d(e),user_id:d(t)}})}async removeVip(e,t){await this._client.callApi({type:"helix",url:"channels/vips",method:"DELETE",scope:"channel:manage:vips",query:{broadcaster_id:d(e),user_id:d(t)}})}};rr=u([w("api","HelixChannelApi")],rr);let Ce=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}getImageUrl(e){var t,r;const a=`url_${e}x`;return(r=(t=this[i].image)===null||t===void 0?void 0:t[a])!==null&&r!==void 0?r:this[i].default_image[a]}get backgroundColor(){return this[i].background_color}get isEnabled(){return this[i].is_enabled}get cost(){return this[i].cost}get title(){return this[i].title}get prompt(){return this[i].prompt}get userInputRequired(){return this[i].is_user_input_required}get maxRedemptionsPerStream(){return this[i].max_per_stream_setting.is_enabled?this[i].max_per_stream_setting.max_per_stream:null}get maxRedemptionsPerUserPerStream(){return this[i].max_per_user_per_stream_setting.is_enabled?this[i].max_per_user_per_stream_setting.max_per_user_per_stream:null}get globalCooldown(){return this[i].global_cooldown_setting.is_enabled?this[i].global_cooldown_setting.global_cooldown_seconds:null}get isPaused(){return this[i].is_paused}get isInStock(){return this[i].is_in_stock}get redemptionsThisStream(){return this[i].redemptions_redeemed_current_stream}get autoFulfill(){return this[i].should_redemptions_skip_request_queue}get autoApproved(){return this[i].should_redemptions_skip_request_queue}get cooldownExpiryDate(){return this[i].cooldown_expires_at?new Date(this[i].cooldown_expires_at):null}};u([C(!1)],Ce.prototype,"_client",void 0);Ce=u([w("api","HelixCustomReward","id")],Ce);let Be=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get userInput(){return this[i].user_input}get isFulfilled(){return this[i].status==="FULFILLED"}get isCanceled(){return this[i].status==="CANCELED"}get redemptionDate(){return new Date(this[i].redeemed_at)}get rewardId(){return this[i].reward.id}get rewardTitle(){return this[i].reward.title}get rewardPrompt(){return this[i].reward.prompt}get rewardCost(){return this[i].reward.cost}async getReward(){return await this._client.channelPoints.getCustomRewardById(this[i].broadcaster_id,this[i].reward.id)}async updateStatus(e){return(await this._client.channelPoints.updateRedemptionStatusByIds(this[i].broadcaster_id,this[i].reward.id,[this[i].id],e))[0]}};u([C(!1)],Be.prototype,"_client",void 0);Be=u([w("api","HelixCustomRewardRedemption","id")],Be);var jt;let nr=jt=class extends V{async getCustomRewards(e,t){return(await this._client.callApi({type:"helix",url:"channel_points/custom_rewards",scope:"channel:read:redemptions",query:{broadcaster_id:d(e),only_manageable_rewards:t==null?void 0:t.toString()}})).data.map(a=>new Ce(a,this._client))}async getCustomRewardsByIds(e,t){return t.length?(await this._client.callApi({type:"helix",url:"channel_points/custom_rewards",scope:"channel:read:redemptions",query:{broadcaster_id:d(e),id:t}})).data.map(a=>new Ce(a,this._client)):[]}async getCustomRewardById(e,t){const r=await this.getCustomRewardsByIds(e,[t]);return r.length?r[0]:null}async createCustomReward(e,t){const r=await this._client.callApi({type:"helix",url:"channel_points/custom_rewards",method:"POST",scope:"channel:manage:redemptions",query:{broadcaster_id:d(e)},jsonBody:jt._transformRewardData(t)});return new Ce(r.data[0],this._client)}async updateCustomReward(e,t,r){const a=await this._client.callApi({type:"helix",url:"channel_points/custom_rewards",method:"PATCH",scope:"channel:manage:redemptions",query:{broadcaster_id:d(e),id:t},jsonBody:jt._transformRewardData(r)});return new Ce(a.data[0],this._client)}async deleteCustomReward(e,t){await this._client.callApi({type:"helix",url:"channel_points/custom_rewards",method:"DELETE",scope:"channel:manage:redemptions",query:{broadcaster_id:d(e),id:t}})}async getRedemptionsByIds(e,t,r){return r.length?(await this._client.callApi({type:"helix",url:"channel_points/custom_rewards/redemptions",scope:"channel:read:redemptions",query:{broadcaster_id:d(e),reward_id:t,id:r}})).data.map(s=>new Be(s,this._client)):[]}async getRedemptionById(e,t,r){const a=await this.getRedemptionsByIds(e,t,[r]);return a.length?a[0]:null}async getRedemptionsForBroadcaster(e,t,r,a){const s=await this._client.callApi({type:"helix",url:"channel_points/custom_rewards/redemptions",scope:"channel:read:redemptions",query:{broadcaster_id:d(e),reward_id:t,status:r,sort:a.newestFirst?"NEWEST":"OLDEST",...L(a)}});return te(s,Be,this._client)}getRedemptionsForBroadcasterPaginated(e,t,r,a){return new z({url:"channel_points/custom_rewards/redemptions",scope:"channel:read:redemptions",query:{broadcaster_id:d(e),reward_id:t,status:r,sort:a.newestFirst?"NEWEST":"OLDEST"}},this._client,s=>new Be(s,this._client),50)}async updateRedemptionStatusByIds(e,t,r,a){return r.length?(await this._client.callApi({type:"helix",url:"channel_points/custom_rewards/redemptions",method:"PATCH",scope:"channel:manage:redemptions",query:{broadcaster_id:d(e),reward_id:t,id:r},jsonBody:{status:a}})).data.map(o=>new Be(o,this._client)):[]}static _transformRewardData(e){var t,r,a;const s={title:e.title,cost:e.cost,prompt:e.prompt,background_color:e.backgroundColor,is_enabled:e.isEnabled,is_user_input_required:e.userInputRequired,should_redemptions_skip_request_queue:e.autoFulfill};return e.maxRedemptionsPerStream!==void 0&&(s.is_max_per_stream_enabled=!!e.maxRedemptionsPerStream,s.max_per_stream=(t=e.maxRedemptionsPerStream)!==null&&t!==void 0?t:0),e.maxRedemptionsPerUserPerStream!==void 0&&(s.is_max_per_user_per_stream_enabled=!!e.maxRedemptionsPerUserPerStream,s.max_per_user_per_stream=(r=e.maxRedemptionsPerUserPerStream)!==null&&r!==void 0?r:0),e.globalCooldown!==void 0&&(s.is_global_cooldown_enabled=!!e.globalCooldown,s.global_cooldown_seconds=(a=e.globalCooldown)!==null&&a!==void 0?a:0),"isPaused"in e&&(s.is_paused=e.isPaused),s}};nr=jt=u([w("api","HelixChannelPointsApi")],nr);let dt=class extends S{get id(){return this[i].id}get name(){return this[i].name}getImageUrl(e){return this[i].images[`url_${e}x`]}};dt=u([w("api","HelixEmote","id")],dt);let ir=class extends dt{constructor(e,t){super(e),this._client=t}get tier(){return this[i].tier||null}get type(){return this[i].emote_type}get emoteSetId(){return this[i].emote_set_id}async getAllEmotesFromSet(){return await this._client.chat.getEmotesFromSets([this[i].emote_set_id])}};u([C(!1)],ir.prototype,"_client",void 0);ir=u([w("api","HelixChannelEmote","id")],ir);let Ei=class extends S{get id(){return this[i].id}getImageUrl(e){return this[i][`image_url_${e}x`]}};Ei=u([w("api","HelixChatBadgeVersion","id")],Ei);let pt=class extends S{get id(){return this[i].set_id}get versions(){return this[i].versions.map(e=>new Ei(e))}getVersion(e){var t;return(t=this.versions.find(r=>r.id===e))!==null&&t!==void 0?t:null}};u([I()],pt.prototype,"versions",null);pt=u([Rt,w("api","HelixChatBadgeSet","id")],pt);let ar=class extends S{get broadcasterId(){return this[i].broadcaster_id}get slowModeEnabled(){return this[i].slow_mode}get slowModeDelay(){return this[i].slow_mode_wait_time}get followerOnlyModeEnabled(){return this[i].follower_mode}get followerOnlyModeDelay(){return this[i].follower_mode_duration}get subscriberOnlyModeEnabled(){return this[i].subscriber_mode}get emoteOnlyModeEnabled(){return this[i].emote_mode}get uniqueChatModeEnabled(){return this[i].unique_chat_mode}};ar=u([w("api","HelixChatSettings","broadcasterId")],ar);let sr=class extends dt{constructor(e,t){super(e),this._client=t}get type(){return this[i].emote_type}get emoteSetId(){return this[i].emote_set_id}get ownerId(){switch(this[i].owner_id){case"0":case"twitch":return null;default:return this[i].owner_id}}async getOwner(){switch(this[i].owner_id){case"0":case"twitch":return null;default:return await this._client.users.getUserById(this[i].owner_id)}}};u([C(!1)],sr.prototype,"_client",void 0);sr=u([w("api","HelixEmoteFromSet","id")],sr);let or=class extends ar{get nonModeratorChatDelayEnabled(){return this[i].non_moderator_chat_delay}get nonModeratorChatDelay(){return this[i].non_moderator_chat_delay_duration}};or=u([w("api","HelixPrivilegedChatSettings","broadcasterId")],or);let lr=class extends V{async getGlobalBadges(){return(await this._client.callApi({type:"helix",url:"chat/badges/global"})).data.map(t=>new pt(t))}async getChannelBadges(e){return(await this._client.callApi({type:"helix",url:"chat/badges",query:{broadcaster_id:d(e)}})).data.map(r=>new pt(r))}async getGlobalEmotes(){return(await this._client.callApi({type:"helix",url:"chat/emotes/global"})).data.map(t=>new dt(t))}async getChannelEmotes(e){return(await this._client.callApi({type:"helix",url:"chat/emotes",query:{broadcaster_id:d(e)}})).data.map(r=>new ir(r,this._client))}async getEmotesFromSets(e){return(await this._client.callApi({type:"helix",url:"chat/emotes/set",query:{emote_set_id:e}})).data.map(r=>new sr(r,this._client))}async getSettings(e){const t=await this._client.callApi({type:"helix",url:"chat/settings",query:{broadcaster_id:d(e)}});return new ar(t.data[0])}async getSettingsPrivileged(e,t){const r=await this._client.callApi({type:"helix",url:"chat/settings",scope:"moderator:read:chat_settings",query:{broadcaster_id:d(e),moderator_id:d(t)}});return new or(r.data[0])}async updateSettings(e,t,r){const a=await this._client.callApi({type:"helix",url:"chat/settings",method:"PATCH",scope:"moderator:manage:chat_settings",query:{broadcaster_id:d(e),moderator_id:d(t)},jsonBody:{slow_mode:r.slowModeEnabled,slow_mode_wait_time:r.slowModeDelay,follower_mode:r.followerOnlyModeEnabled,follower_mode_duration:r.followerOnlyModeDelay,subscriber_mode:r.subscriberOnlyModeEnabled,emote_mode:r.emoteOnlyModeEnabled,unique_chat_mode:r.uniqueChatModeEnabled,non_moderator_chat_delay:r.nonModeratorChatDelayEnabled,non_moderator_chat_delay_duration:r.nonModeratorChatDelay}});return new or(a.data[0])}async sendAnnouncement(e,t,r){await this._client.callApi({type:"helix",url:"chat/announcements",method:"POST",scope:"moderator:manage:announcements",query:{broadcaster_id:d(e),moderator_id:d(t)},jsonBody:{message:r.message,color:r.color}})}async getColorsForUsers(e){const t=await this._client.callApi({type:"helix",url:"chat/color",query:{user_id:e.map(d)}});return new Map(t.data.map(r=>[r.user_id,r.color||null]))}async getColorForUser(e){const t=d(e);return(await this.getColorsForUsers([t])).get(t)}async setColorForUser(e,t){await this._client.callApi({type:"helix",url:"chat/color",method:"PUT",scope:"user:manage:chat_color",query:{user_id:d(e),color:t}})}};lr=u([w("api","HelixChatApi")],lr);let ht=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get url(){return this[i].url}get embedUrl(){return this[i].embed_url}get broadcasterId(){return this[i].broadcaster_id}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get creatorId(){return this[i].creator_id}get creatorDisplayName(){return this[i].creator_name}async getCreator(){return await this._client.users.getUserById(this[i].creator_id)}get videoId(){return this[i].video_id}async getVideo(){return await this._client.videos.getVideoById(this[i].video_id)}get gameId(){return this[i].game_id}async getGame(){return await this._client.games.getGameById(this[i].game_id)}get language(){return this[i].language}get title(){return this[i].title}get views(){return this[i].view_count}get creationDate(){return new Date(this[i].created_at)}get thumbnailUrl(){return this[i].thumbnail_url}get duration(){return this[i].duration}get vodOffset(){return this[i].vod_offset}};u([C(!1)],ht.prototype,"_client",void 0);ht=u([w("api","HelixClip","id")],ht);let ur=class extends V{async getClipsForBroadcaster(e,t={}){return await this._getClips({...t,filterType:"broadcaster_id",ids:d(e)})}getClipsForBroadcasterPaginated(e,t={}){return this._getClipsPaginated({...t,filterType:"broadcaster_id",ids:d(e)})}async getClipsForGame(e,t={}){return await this._getClips({...t,filterType:"game_id",ids:e})}getClipsForGamePaginated(e,t={}){return this._getClipsPaginated({...t,filterType:"game_id",ids:e})}async getClipsByIds(e){return(await this._getClips({filterType:"id",ids:e})).data}async getClipById(e){const t=await this.getClipsByIds([e]);return t.length?t[0]:null}async createClip(e){const{channelId:t,createAfterDelay:r=!1}=e;return(await this._client.callApi({type:"helix",url:"clips",method:"POST",scope:"clips:edit",query:{broadcaster_id:t,has_delay:r.toString()}})).data[0].id}async _getClips(e){const{filterType:t,ids:r,startDate:a,endDate:s,...o}=e;if(!r.length)return{data:[]};const l=await this._client.callApi({type:"helix",url:"clips",query:{[t]:r,started_at:a,ended_at:s,...L(o)}});return te(l,ht,this._client)}_getClipsPaginated(e){const{filterType:t,ids:r,startDate:a,endDate:s}=e;return new z({url:"clips",query:{[t]:r,started_at:a,ended_at:s}},this._client,o=>new ht(o,this._client))}};ur=u([w("api","HelixClipApi")],ur);let Ae=class extends z{async getTotalCount(){var e;return((e=this._currentData)!==null&&e!==void 0?e:await this._fetchData({query:{after:void 0}})).total}};Ae=u([w("api","HelixPaginatedRequestWithTotal")],Ae);let se=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get status(){return this[i].status}get type(){return this[i].type}get cost(){return this[i].cost}get condition(){return this[i].condition}get creationDate(){return new Date(this[i].created_at)}async unsubscribe(){await this._client.eventSub.deleteSubscription(this[i].id)}get _transport(){return this[i].transport}set _status(e){this[i].status=e}};u([C(!1)],se.prototype,"_client",void 0);se=u([w("api","HelixEventSubSubscription","id")],se);let cr=class extends V{async getSubscriptions(e){const t=await this._client.callApi({type:"helix",url:"eventsub/subscriptions",query:L(e)});return We(t,se,this._client)}getSubscriptionsPaginated(){return new Ae({url:"eventsub/subscriptions"},this._client,e=>new se(e,this._client))}async getSubscriptionsForStatus(e,t){const r=await this._client.callApi({type:"helix",url:"eventsub/subscriptions",query:{...L(t),status:e}});return We(r,se,this._client)}getSubscriptionsForStatusPaginated(e){return new Ae({url:"eventsub/subscriptions",query:{status:e}},this._client,t=>new se(t,this._client))}async getSubscriptionsForType(e,t){const r=await this._client.callApi({type:"helix",url:"eventsub/subscriptions",query:{...L(t),type:e}});return We(r,se,this._client)}getSubscriptionsForTypePaginated(e){return new Ae({url:"eventsub/subscriptions",query:{type:e}},this._client,t=>new se(t,this._client))}async getSubscriptionsForUser(e,t){const r=await this._client.callApi({type:"helix",url:"eventsub/subscriptions",query:{...L(t),user_id:d(e)}});return We(r,se,this._client)}getSubscriptionsForUserPaginated(e){return new Ae({url:"eventsub/subscriptions",query:{user_id:d(e)}},this._client,t=>new se(t,this._client))}async createSubscription(e,t,r,a){const s=await this._client.callApi({type:"helix",url:"eventsub/subscriptions",method:"POST",jsonBody:{type:e,version:t,condition:r,transport:a}});return new se(s.data[0],this._client)}async deleteSubscription(e){await this._client.callApi({type:"helix",url:"eventsub/subscriptions",method:"DELETE",query:{id:e}})}async deleteAllSubscriptions(){await this._deleteSubscriptionsWithCondition()}async deleteBrokenSubscriptions(){await this._deleteSubscriptionsWithCondition(e=>e.status!=="enabled"&&e.status!=="webhook_callback_verification_pending")}async subscribeToStreamOnlineEvents(e,t){return await this.createSubscription("stream.online","1",{broadcaster_user_id:d(e)},t)}async subscribeToStreamOfflineEvents(e,t){return await this.createSubscription("stream.offline","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelUpdateEvents(e,t){return await this.createSubscription("channel.update","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelFollowEvents(e,t){return await this.createSubscription("channel.follow","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelSubscriptionEvents(e,t){return await this.createSubscription("channel.subscribe","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelSubscriptionGiftEvents(e,t){return await this.createSubscription("channel.subscription.gift","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelSubscriptionMessageEvents(e,t){return await this.createSubscription("channel.subscription.message","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelSubscriptionEndEvents(e,t){return await this.createSubscription("channel.subscription.end","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelCheerEvents(e,t){return await this.createSubscription("channel.cheer","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelBanEvents(e,t){return await this.createSubscription("channel.ban","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelUnbanEvents(e,t){return await this.createSubscription("channel.unban","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelModeratorAddEvents(e,t){return await this.createSubscription("channel.moderator.add","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelModeratorRemoveEvents(e,t){return await this.createSubscription("channel.moderator.remove","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRaidEventsFrom(e,t){return await this.createSubscription("channel.raid","1",{from_broadcaster_user_id:d(e)},t)}async subscribeToChannelRaidEventsTo(e,t){return await this.createSubscription("channel.raid","1",{to_broadcaster_user_id:d(e)},t)}async subscribeToChannelRewardAddEvents(e,t){return await this.createSubscription("channel.channel_points_custom_reward.add","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRewardUpdateEvents(e,t){return await this.createSubscription("channel.channel_points_custom_reward.update","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRewardUpdateEventsForReward(e,t,r){return await this.createSubscription("channel.channel_points_custom_reward.update","1",{broadcaster_user_id:d(e),reward_id:t},r)}async subscribeToChannelRewardRemoveEvents(e,t){return await this.createSubscription("channel.channel_points_custom_reward.remove","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRewardRemoveEventsForReward(e,t,r){return await this.createSubscription("channel.channel_points_custom_reward.remove","1",{broadcaster_user_id:d(e),reward_id:t},r)}async subscribeToChannelRedemptionAddEvents(e,t){return await this.createSubscription("channel.channel_points_custom_reward_redemption.add","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRedemptionAddEventsForReward(e,t,r){return await this.createSubscription("channel.channel_points_custom_reward_redemption.add","1",{broadcaster_user_id:d(e),reward_id:t},r)}async subscribeToChannelRedemptionUpdateEvents(e,t){return await this.createSubscription("channel.channel_points_custom_reward_redemption.update","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelRedemptionUpdateEventsForReward(e,t,r){return await this.createSubscription("channel.channel_points_custom_reward_redemption.update","1",{broadcaster_user_id:d(e),reward_id:t},r)}async subscribeToChannelPollBeginEvents(e,t){return await this.createSubscription("channel.poll.begin","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPollProgressEvents(e,t){return await this.createSubscription("channel.poll.progress","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPollEndEvents(e,t){return await this.createSubscription("channel.poll.end","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPredictionBeginEvents(e,t){return await this.createSubscription("channel.prediction.begin","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPredictionProgressEvents(e,t){return await this.createSubscription("channel.prediction.progress","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPredictionLockEvents(e,t){return await this.createSubscription("channel.prediction.lock","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelPredictionEndEvents(e,t){return await this.createSubscription("channel.prediction.end","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelGoalBeginEvents(e,t){return await this.createSubscription("channel.goal.begin","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelGoalProgressEvents(e,t){return await this.createSubscription("channel.goal.progress","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelGoalEndEvents(e,t){return await this.createSubscription("channel.goal.end","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelHypeTrainBeginEvents(e,t){return await this.createSubscription("channel.hype_train.begin","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelHypeTrainProgressEvents(e,t){return await this.createSubscription("channel.hype_train.progress","1",{broadcaster_user_id:d(e)},t)}async subscribeToChannelHypeTrainEndEvents(e,t){return await this.createSubscription("channel.hype_train.end","1",{broadcaster_user_id:d(e)},t)}async subscribeToExtensionBitsTransactionCreateEvents(e,t){return await this.createSubscription("extension.bits_transaction.create","1",{extension_client_id:e},t)}async subscribeToUserAuthorizationGrantEvents(e,t){return await this.createSubscription("user.authorization.grant","1",{client_id:e},t)}async subscribeToUserAuthorizationRevokeEvents(e,t){return await this.createSubscription("user.authorization.revoke","1",{client_id:e},t)}async subscribeToUserUpdateEvents(e,t){return await this.createSubscription("user.update","1",{user_id:d(e)},t)}async _deleteSubscriptionsWithCondition(e){const t=this.getSubscriptionsPaginated();for await(const r of t)(!e||e(r))&&await r.unsubscribe()}};cr=u([w("api","HelixEventSubApi")],cr);let ft=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].broadcaster_id}get displayName(){return this[i].broadcaster_name}async getChannel(){return await this._client.channels.getChannelInfoById(this[i].broadcaster_id)}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get gameId(){return this[i].game_id}get gameName(){return this[i].game_name}async getGame(){return await this._client.games.getGameById(this[i].game_id)}get title(){return this[i].title}};u([C(!1)],ft.prototype,"_client",void 0);ft=u([w("api","HelixChannelReference","id")],ft);let dr=class extends S{get sku(){return this[i].sku}get cost(){return this[i].cost.amount}get displayName(){return this[i].display_name}get inDevelopment(){return this[i].in_development}get isBroadcast(){return this[i].is_broadcast}get expirationDate(){return Ue(this[i].expiration,e=>new Date(e))}};dr=u([w("api","HelixExtensionBitsProduct","sku")],dr);let yt=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get transactionDate(){return new Date(this[i].timestamp)}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_name}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get productType(){return this[i].product_type}get productSku(){return this[i].product_data.sku}get productCost(){return this[i].product_data.cost.amount}get productDisplayName(){return this[i].product_data.displayName}get productInDevelopment(){return this[i].product_data.inDevelopment}};u([C(!1)],yt.prototype,"_client",void 0);yt=u([w("api","HelixExtensionTransaction","id")],yt);let pr=class extends V{async getReleasedExtension(e,t){const r=await this._client.callApi({type:"helix",url:"extensions/released",query:{extension_id:e,extension_version:t}});return new xi(r.data[0])}async getLiveChannelsWithExtension(e,t){const r=await this._client.callApi({type:"helix",url:"extensions/live",query:{extension_id:e,...L(t)}});return te(r,ft,this._client)}getLiveChannelsWithExtensionPaginated(e){return new z({url:"extensions/live",query:{extension_id:e}},this._client,t=>new ft(t,this._client))}async getExtensionBitsProducts(e){return(await this._client.callApi({type:"helix",url:"bits/extensions",query:{should_include_all:e==null?void 0:e.toString()}})).data.map(r=>new dr(r))}async putExtensionBitsProduct(e){const t=await this._client.callApi({type:"helix",url:"bits/extensions",method:"PUT",jsonBody:{sku:e.sku,cost:{amount:e.cost,type:"bits"},display_name:e.displayName,in_development:e.inDevelopment,expiration:e.expirationDate,is_broadcast:e.broadcast}});return new dr(t.data[0])}async getExtensionTransactions(e,t={}){const r=await this._client.callApi({type:"helix",url:"extensions/transactions",query:{extension_id:e,id:t.transactionIds,...L(t)}});return te(r,yt,this._client)}getExtensionTransactionsPaginated(e,t={}){return new z({url:"extensions/transactions",query:{extension_id:e,id:t.transactionIds}},this._client,r=>new yt(r,this._client))}};pr=u([w("api","HelixExtensionsApi")],pr);let Ie=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get name(){return this[i].name}get boxArtUrl(){return this[i].box_art_url}getBoxArtUrl(e,t){return this[i].box_art_url.replace("{width}",e.toString()).replace("{height}",t.toString())}async getStreams(e){return await this._client.streams.getStreams({...e,game:this[i].id})}getStreamsPaginated(){return this._client.streams.getStreamsPaginated({game:this[i].id})}};u([C(!1)],Ie.prototype,"_client",void 0);Ie=u([w("api","HelixGame","id")],Ie);let hr=class extends V{async getGamesByIds(e){return await this._getGames("id",e)}async getGamesByNames(e){return await this._getGames("name",e)}async getGameById(e){const t=await this._getGames("id",[e]);return t.length?t[0]:null}async getGameByName(e){const t=await this._getGames("name",[e]);return t.length?t[0]:null}async getTopGames(e){const t=await this._client.callApi({type:"helix",url:"games/top",query:L(e)});return te(t,Ie,this._client)}getTopGamesPaginated(){return new z({url:"games/top"},this._client,e=>new Ie(e,this._client))}async _getGames(e,t){return t.length?(await this._client.callApi({type:"helix",url:"games",query:{[e]:t}})).data.map(a=>new Ie(a,this._client)):[]}};hr=u([w("api","HelixGameApi")],hr);let fr=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get broadcasterId(){return this[i].broadcaster_id}get broadcasterDisplayName(){return this[i].broadcaster_name}get broadcasterName(){return this[i].broadcaster_login}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get type(){return this[i].type}get description(){return this[i].description}get currentAmount(){return this[i].current_amount}get targetAmount(){return this[i].target_amount}get creationDate(){return this[i].created_at}};u([C(!1)],fr.prototype,"_client",void 0);fr=u([w("api","HelixGoal","id")],fr);let yr=class extends V{async getGoals(e){return(await this._client.callApi({type:"helix",url:"goals",query:{broadcaster_id:d(e)}})).data.map(r=>new fr(r,this._client))}};yr=u([w("api","HelixGoalApi")],yr);let gt=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user}async getUser(){return await this._client.users.getUserById(this[i].user)}get type(){return this[i].type}get total(){return this[i].total}};u([C(!1)],gt.prototype,"_client",void 0);gt=u([w("api","HelixHypeTrainContribution","userId")],gt);let mt=class extends S{constructor(e,t){super(e),this._client=t}get eventId(){return this[i].id}get eventType(){return this[i].event_type}get eventDate(){return new Date(this[i].event_timestamp)}get eventVersion(){return this[i].version}get id(){return this[i].id}get broadcasterId(){return this[i].event_data.broadcaster_id}async getBroadcaster(){return await this._client.users.getUserById(this[i].event_data.broadcaster_id)}get level(){return this[i].event_data.level}get startDate(){return new Date(this[i].event_data.started_at)}get expiryDate(){return new Date(this[i].event_data.expires_at)}get cooldownDate(){return new Date(this[i].event_data.cooldown_end_time)}get total(){return this[i].event_data.total}get goal(){return this[i].event_data.goal}get lastContribution(){return new gt(this[i].event_data.last_contribution,this._client)}get topContributions(){return this[i].event_data.top_contributions.map(e=>new gt(e,this._client))}};u([C(!1)],mt.prototype,"_client",void 0);mt=u([w("api","HelixHypeTrainEvent","id")],mt);class Io extends V{async getHypeTrainEventsForBroadcaster(e,t){const r=await this._client.callApi({type:"helix",url:"hypetrain/events",scope:"channel:read:hype_train",query:{broadcaster_id:d(e),...L(t)}});return te(r,mt,this._client)}getHypeTrainEventsForBroadcasterPaginated(e){return new z({url:"hypetrain/events",scope:"channel:read:hype_train",query:{broadcaster_id:d(e)}},this._client,t=>new mt(t,this._client))}}let gr=class extends S{get broadcasterId(){return this[i].broadcaster_id}get moderatorId(){return this[i].moderator_id}get overallLevel(){return this[i].overall_level?this[i].overall_level:null}get disability(){return this[i].disability}get aggression(){return this[i].aggression}get sexualitySexOrGender(){return this[i].sexuality_sex_or_gender}get misogyny(){return this[i].misogyny}get bullying(){return this[i].bullying}get swearing(){return this[i].swearing}get raceEthnicityOrReligion(){return this[i].race_ethnicity_or_religion}get sexBasedTerms(){return this[i].sex_based_terms}};gr=u([w("api","HelixAutoModSettings","broadcasterId")],gr);let Ri=class extends S{get messageId(){return this[i].msg_id}get isPermitted(){return this[i].is_permitted}};Ri=u([w("api","HelixAutoModStatus","messageId")],Ri);let _t=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get expiryDate(){return this[i].expires_at?new Date(this[i].expires_at):null}};u([C(!1)],_t.prototype,"_client",void 0);_t=u([w("api","HelixBan","userId")],_t);let Ci=class extends S{get broadcasterId(){return this[i].broadcaster_id}get creationDate(){return new Date(this[i].created_at)}get endDate(){return Ue(this[i].end_time,e=>new Date(e))}get moderatorId(){return this[i].moderator_id}get userId(){return this[i].user_id}};Ci=u([w("api","HelixBanUser","userId")],Ci);let mr=class extends S{get broadcasterId(){return this[i].broadcaster_id}get creationDate(){return new Date(this[i].created_at)}get expirationDate(){return this[i].expires_at?new Date(this[i].expires_at):null}get id(){return this[i].id}get moderatorId(){return this[i].moderator_id}get text(){return this[i].text}get updatedDate(){return new Date(this[i].updated_at)}};mr=u([w("api","HelixBlockedTerm","id")],mr);let vt=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}};u([C(!1)],vt.prototype,"_client",void 0);vt=u([w("api","HelixModerator","userId")],vt);let _r=class extends V{async getBannedUsers(e,t){const r=await this._client.callApi({type:"helix",url:"moderation/banned",scope:"moderation:read",query:{broadcaster_id:d(e),user_id:t==null?void 0:t.userId,...L(t)}});return te(r,_t,this._client)}getBannedUsersPaginated(e){return new z({url:"moderation/banned",scope:"moderation:read",query:{broadcaster_id:d(e)}},this._client,t=>new _t(t,this._client),50)}async checkUserBan(e,t){const r=d(t);return(await this.getBannedUsers(e,{userId:r})).data.some(s=>s.userId===r)}async getModerators(e,t){const r=await this._client.callApi({type:"helix",url:"moderation/moderators",scope:"moderation:read",query:{broadcaster_id:d(e),user_id:t==null?void 0:t.userId,...L(t)}});return te(r,vt,this._client)}getModeratorsPaginated(e){return new z({url:"moderation/moderators",scope:"moderation:read",query:{broadcaster_id:d(e)}},this._client,t=>new vt(t,this._client))}async checkUserMod(e,t){const r=d(t);return(await this.getModerators(e,{userId:r})).data.some(s=>s.userId===r)}async addModerator(e,t){await this._client.callApi({type:"helix",url:"moderation/moderators",method:"POST",scope:"channel:manage:moderators",query:{broadcaster_id:d(e),user_id:d(t)}})}async removeModerator(e,t){await this._client.callApi({type:"helix",url:"moderation/moderators",method:"DELETE",scope:"channel:manage:moderators",query:{broadcaster_id:d(e),user_id:d(t)}})}async checkAutoModStatus(e,t){return(await this._client.callApi({type:"helix",url:"moderation/enforcements/status",method:"POST",scope:"moderation:read",query:{broadcaster_id:d(e)},jsonBody:{data:t}})).data.map(a=>new Ri(a))}async processHeldAutoModMessage(e,t,r){await this._client.callApi({type:"helix",url:"moderation/automod/message",method:"POST",scope:"moderator:manage:automod",jsonBody:{user_id:d(e),msg_id:t,action:r?"ALLOW":"DENY"}})}async getAutoModSettings(e,t){return(await this._client.callApi({type:"helix",url:"moderation/automod/settings",scope:"moderator:read:automod_settings",query:{broadcaster_id:d(e),moderator_id:d(t)}})).data.map(a=>new gr(a))}async updateAutoModSettings(e,t,r){return(await this._client.callApi({type:"helix",url:"moderation/automod/settings",method:"PUT",scope:"moderator:manage:automod_settings",query:{broadcaster_id:d(e),moderator_id:d(t)},jsonBody:{overall_level:r.overallLevel,aggression:r.aggression,bullying:r.bullying,disability:r.disability,misogyny:r.misogyny,race_ethnicity_or_religion:r.raceEthnicityOrReligion,sex_based_terms:r.sexBasedTerms,sexuality_sex_or_gender:r.sexualitySexOrGender,swearing:r.swearing}})).data.map(s=>new gr(s))}async banUser(e,t,r){return(await this._client.callApi({type:"helix",url:"moderation/bans",method:"POST",scope:"moderator:manage:banned_users",query:{broadcaster_id:d(e),moderator_id:d(t)},jsonBody:{data:{duration:r.duration,reason:r.reason,user_id:r.userId}}})).data.map(s=>new Ci(s))}async unbanUser(e,t,r){await this._client.callApi({type:"helix",url:"moderation/bans",method:"DELETE",scope:"moderator:manage:banned_users",query:{broadcaster_id:d(e),moderator_id:d(t),user_id:d(r)}})}async getBlockedTerms(e,t,r){const a=await this._client.callApi({type:"helix",url:"moderation/blocked_terms",scope:"moderator:read:blocked_terms",query:{broadcaster_id:d(e),moderator_id:d(t),...L(r)}});return te(a,mr,this._client)}async addBlockedTerm(e,t,r){return(await this._client.callApi({type:"helix",url:"moderation/blocked_terms",method:"POST",scope:"moderator:manage:blocked_terms",query:{broadcaster_id:d(e),moderator_id:d(t)},jsonBody:{text:r}})).data.map(s=>new mr(s))}async removeBlockedTerm(e,t,r){await this._client.callApi({type:"helix",url:"moderation/blocked_terms",method:"DELETE",scope:"moderator:manage:blocked_terms",query:{broadcaster_id:d(e),moderator_id:d(t),id:r}})}async deleteChatMessages(e,t,r){await this._client.callApi({type:"helix",url:"moderation/chat",method:"DELETE",scope:"moderator:manage:chat_messages",query:{broadcaster_id:d(e),moderator_id:d(t),message_id:r}})}};_r=u([w("api","HelixModerationApi")],_r);let Bi=class extends S{get id(){return this[i].id}get title(){return this[i].title}get totalVotes(){return this[i].votes}get channelPointsVotes(){return this[i].channel_points_votes}get bitsVotes(){return this[i].bits_votes}};Bi=u([w("api","HelixPollChoice","id")],Bi);let xe=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get title(){return this[i].title}get isBitsVotingEnabled(){return this[i].bits_voting_enabled}get bitsPerVote(){return this[i].bits_per_vote}get isChannelPointsVotingEnabled(){return this[i].channel_points_voting_enabled}get channelPointsPerVote(){return this[i].channel_points_per_vote}get status(){return this[i].status}get durationInSeconds(){return this[i].duration}get startDate(){return new Date(this[i].started_at)}get endDate(){return new Date(this.startDate.getTime()+this[i].duration*1e3)}get choices(){return this[i].choices.map(e=>new Bi(e))}};u([C(!1)],xe.prototype,"_client",void 0);xe=u([w("api","HelixPoll","id")],xe);let vr=class extends V{async getPolls(e,t){const r=await this._client.callApi({type:"helix",url:"polls",scope:"channel:read:polls",query:{broadcaster_id:d(e),...L(t)}});return te(r,xe,this._client)}getPollsPaginated(e){return new z({url:"polls",scope:"channel:read:polls",query:{broadcaster_id:d(e)}},this._client,t=>new xe(t,this._client),20)}async getPollsByIds(e,t){return t.length?(await this._client.callApi({type:"helix",url:"polls",scope:"channel:read:polls",query:{broadcaster_id:d(e),id:t}})).data.map(a=>new xe(a,this._client)):[]}async getPollById(e,t){const r=await this.getPollsByIds(e,[t]);return r.length?r[0]:null}async createPoll(e,t){var r,a;const s=await this._client.callApi({type:"helix",url:"polls",method:"POST",scope:"channel:manage:polls",jsonBody:{broadcaster_id:d(e),title:t.title,choices:t.choices.map(o=>({title:o})),duration:t.duration,bits_voting_enabled:t.bitsPerVote!=null,bits_per_vote:(r=t.bitsPerVote)!==null&&r!==void 0?r:0,channel_points_voting_enabled:t.channelPointsPerVote!=null,channel_points_per_vote:(a=t.channelPointsPerVote)!==null&&a!==void 0?a:0}});return new xe(s.data[0],this._client)}async endPoll(e,t,r=!0){const a=await this._client.callApi({type:"helix",url:"polls",method:"PATCH",scope:"channel:manage:polls",jsonBody:{broadcaster_id:d(e),id:t,status:r?"TERMINATED":"ARCHIVED"}});return new xe(a.data[0],this._client)}};vr=u([w("api","HelixPollApi")],vr);let br=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].id}get userName(){return this[i].login}get userDisplayName(){return this[i].name}async getUser(){return await this._client.users.getUserById(this[i].id)}get channelPointsUsed(){return this[i].channel_points_used}get channelPointsWon(){return this[i].channel_points_won}};u([C(!1)],br.prototype,"_client",void 0);br=u([w("api","HelixPredictor","userId")],br);let wr=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get title(){return this[i].title}get users(){return this[i].users}get totalChannelPoints(){return this[i].channel_points}get color(){return this[i].color}get topPredictors(){var e,t;return(t=(e=this[i].top_predictors)===null||e===void 0?void 0:e.map(r=>new br(r,this._client)))!==null&&t!==void 0?t:[]}};u([C(!1)],wr.prototype,"_client",void 0);wr=u([w("api","HelixPredictionOutcome","id")],wr);let Se=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get title(){return this[i].title}get status(){return this[i].status}get autoLockAfter(){return this[i].prediction_window}get creationDate(){return new Date(this[i].created_at)}get endDate(){return this[i].ended_at?new Date(this[i].ended_at):null}get lockDate(){return this[i].locked_at?new Date(this[i].locked_at):null}get outcomes(){return this[i].outcomes.map(e=>new wr(e,this._client))}};u([C(!1)],Se.prototype,"_client",void 0);Se=u([w("api","HelixPrediction","id")],Se);let xr=class extends V{async getPredictions(e,t){const r=await this._client.callApi({type:"helix",url:"predictions",scope:"channel:read:predictions",query:{broadcaster_id:d(e),...L(t)}});return te(r,Se,this._client)}getPredictionsPaginated(e){return new z({url:"predictions",scope:"channel:read:predictions",query:{broadcaster_id:d(e)}},this._client,t=>new Se(t,this._client),20)}async getPredictionsByIds(e,t){return t.length?(await this._client.callApi({type:"helix",url:"predictions",scope:"channel:read:predictions",query:{broadcaster_id:d(e),id:t}})).data.map(a=>new Se(a,this._client)):[]}async getPredictionById(e,t){const r=await this.getPredictionsByIds(e,[t]);return r.length?r[0]:null}async createPrediction(e,t){const r=await this._client.callApi({type:"helix",url:"predictions",method:"POST",scope:"channel:manage:predictions",jsonBody:{broadcaster_id:d(e),title:t.title,outcomes:t.outcomes.map(a=>({title:a})),prediction_window:t.autoLockAfter}});return new Se(r.data[0],this._client)}async lockPrediction(e,t){return await this._endPrediction(e,t,"LOCKED")}async resolvePrediction(e,t,r){return await this._endPrediction(e,t,"RESOLVED",r)}async cancelPrediction(e,t){return await this._endPrediction(e,t,"CANCELED")}async _endPrediction(e,t,r,a){const s=await this._client.callApi({type:"helix",url:"predictions",method:"PATCH",scope:"channel:manage:predictions",jsonBody:{broadcaster_id:d(e),id:t,status:r,winning_outcome_id:a}});return new Se(s.data[0],this._client)}};xr=u([w("api","HelixPredictionApi")],xr);let Te=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get startDate(){return new Date(this[i].start_time)}get endDate(){return new Date(this[i].end_time)}get title(){return this[i].title}get cancelEndDate(){return Ue(this[i].canceled_until,e=>new Date(e))}get categoryId(){var e,t;return(t=(e=this[i].category)===null||e===void 0?void 0:e.id)!==null&&t!==void 0?t:null}get categoryName(){var e,t;return(t=(e=this[i].category)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:null}async getCategory(){var e;const t=(e=this[i].category)===null||e===void 0?void 0:e.id;return t?await this._client.games.getGameById(t):null}get isRecurring(){return this[i].is_recurring}};u([C(!1)],Te.prototype,"_client",void 0);Te=u([w("api","HelixScheduleSegment","id")],Te);class Oc extends z{constructor(e,t,r){var a;super({url:"schedule",query:{broadcaster_id:d(e),start_time:r==null?void 0:r.startDate,utc_offset:(a=r==null?void 0:r.utcOffset)===null||a===void 0?void 0:a.toString()}},t,s=>new Te(s,t),25)}async _fetchData(e={}){const t=await super._fetchData(e);return{data:t.data.segments,pagination:t.pagination}}}let Sr=class extends S{constructor(e,t){super(e),this._client=t}get segments(){return this[i].segments.map(e=>new Te(e,this._client))}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get vacationStartDate(){var e;const t=(e=this[i].vacation)===null||e===void 0?void 0:e.start_time;return t?new Date(t):null}get vacationEndDate(){var e;const t=(e=this[i].vacation)===null||e===void 0?void 0:e.end_time;return t?new Date(t):null}};u([C(!1)],Sr.prototype,"_client",void 0);Sr=u([w("api","HelixSchedule","broadcasterId")],Sr);class To extends V{async getSchedule(e,t){var r;const a=await this._client.callApi({type:"helix",url:"schedule",query:{broadcaster_id:d(e),start_time:t==null?void 0:t.startDate,utc_offset:(r=t==null?void 0:t.utcOffset)===null||r===void 0?void 0:r.toString(),...L(t)}});return{data:new Sr(a.data,this._client),cursor:a.pagination.cursor}}getScheduleSegmentsPaginated(e,t){return new Oc(e,this._client,t)}async getScheduleSegmentsByIds(e,t){return(await this._client.callApi({type:"helix",url:"schedule",query:{broadcaster_id:d(e),id:t}})).data.segments.map(a=>new Te(a,this._client))}async getScheduleSegmentById(e,t){const r=await this.getScheduleSegmentsByIds(e,[t]);return r.length?r[0]:null}async getScheduleAsIcal(e){return await this._client.callApi({type:"helix",url:"schedule/icalendar",query:{broadcaster_id:d(e)}})}async updateScheduleSettings(e,t){const r=t.vacation?{is_vacation_enabled:"true",vacation_start_time:t.vacation.startDate,vacation_end_time:t.vacation.endDate,timezone:t.vacation.timezone}:{is_vacation_enabled:"false"};await this._client.callApi({type:"helix",url:"schedule/settings",method:"PATCH",scope:"channel:manage:schedule",query:{broadcaster_id:d(e),...r}})}async createScheduleSegment(e,t){const r=await this._client.callApi({type:"helix",url:"schedule/segment",method:"POST",scope:"channel:manage:schedule",query:{broadcaster_id:d(e)},jsonBody:{start_time:t.startDate,timezone:t.timezone,is_recurring:t.isRecurring,duration:t.duration,category_id:t.categoryId,title:t.title}});return new Te(r.data.segments[0],this._client)}async updateScheduleSegment(e,t,r){const a=await this._client.callApi({type:"helix",url:"schedule/segment",method:"PATCH",scope:"channel:manage:schedule",query:{broadcaster_id:d(e),id:t},jsonBody:{start_time:r.startDate,timezone:r.timezone,is_canceled:r.isCanceled,duration:r.duration,category_id:r.categoryId,title:r.title}});return new Te(a.data.segments[0],this._client)}async deleteScheduleSegment(e,t){await this._client.callApi({type:"helix",url:"schedule/segment",method:"DELETE",scope:"channel:manage:schedule",query:{broadcaster_id:d(e),id:t}})}}let bt=class extends S{constructor(e,t){super(e),this._client=t}get language(){return this[i].broadcaster_language}get id(){return this[i].id}get name(){return this[i].broadcaster_login}get displayName(){return this[i].display_name}async getUser(){return await this._client.users.getUserById(this[i].id)}get gameId(){return this[i].game_id}get gameName(){return this[i].game_name}async getGame(){return await this._client.games.getGameById(this[i].game_id)}get isLive(){return this[i].is_live}get tagIds(){return this[i].tag_ids}async getTags(){return await this._client.tags.getStreamTagsByIds(this[i].tag_ids)}get thumbnailUrl(){return this[i].thumbnail_url}get startDate(){return this[i].is_live?new Date(this[i].started_at):null}};u([C(!1)],bt.prototype,"_client",void 0);bt=u([w("api","HelixChannelSearchResult","id")],bt);let Ar=class extends V{async searchCategories(e,t){const r=await this._client.callApi({type:"helix",url:"search/categories",query:{query:e,...L(t)}});return te(r,Ie,this._client)}searchCategoriesPaginated(e){return new z({url:"search/categories",query:{query:e}},this._client,t=>new Ie(t,this._client))}async searchChannels(e,t={}){var r;const a=await this._client.callApi({type:"helix",url:"search/channels",query:{query:e,live_only:(r=t.liveOnly)===null||r===void 0?void 0:r.toString(),...L(t)}});return te(a,bt,this._client)}searchChannelsPaginated(e,t={}){var r;return new z({url:"search/channels",query:{query:e,live_only:(r=t.liveOnly)===null||r===void 0?void 0:r.toString()}},this._client,a=>new bt(a,this._client))}};Ar=u([w("api","HelixSearchApi")],Ar);class Dc extends Fe{constructor(e){super("Your stream needs to be live to do this",e)}}let Qe=class extends S{get id(){return this[i].tag_id}get isAuto(){return this[i].is_auto}getName(e){return this[i].localization_names[e]}getDescription(e){return this[i].localization_descriptions[e]}};Qe=u([w("api","HelixTag","id")],Qe);let qe=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get gameId(){return this[i].game_id}get gameName(){return this[i].game_name}async getGame(){return this[i].game_id?await this._client.games.getGameById(this[i].game_id):null}get type(){return this[i].type}get title(){return this[i].title}get viewers(){return this[i].viewer_count}get startDate(){return new Date(this[i].started_at)}get language(){return this[i].language}get thumbnailUrl(){return this[i].thumbnail_url}getThumbnailUrl(e,t){return this[i].thumbnail_url.replace("{width}",e.toString()).replace("{height}",t.toString())}get tagIds(){var e;return(e=this[i].tag_ids)!==null&&e!==void 0?e:[]}async getTags(){var e;return await this._client.tags.getStreamTagsByIds((e=this[i].tag_ids)!==null&&e!==void 0?e:[])}get isMature(){return this[i].is_mature}};u([C(!1)],qe.prototype,"_client",void 0);qe=u([w("api","HelixStream","id")],qe);let wt=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get creationDate(){return new Date(this[i].created_at)}get description(){return this[i].description}get positionInSeconds(){return this[i].position_seconds}};u([C(!1)],wt.prototype,"_client",void 0);wt=u([w("api","HelixStreamMarker","id")],wt);let qi=class extends wt{constructor(e,t,r){super(e,r),this._videoId=t}get url(){return this[i].URL}get videoId(){return this._videoId}async getVideo(){return await this._client.videos.getVideoById(this._videoId)}};qi=u([w("api","HelixStreamMarkerWithVideo","id")],qi);var kt;let Ir=kt=class extends V{async getStreams(e={}){const t=await this._client.callApi({url:"streams",type:"helix",query:{...L(e),game_id:e.game,language:e.language,type:e.type,user_id:e.userId,user_login:e.userName}});return te(t,qe,this._client)}getStreamsPaginated(e={}){return new z({url:"streams",query:{game_id:e.game,language:e.language,type:e.type,user_id:e.userId,user_login:e.userName}},this._client,t=>new qe(t,this._client))}async getStreamsByUserNames(e){return(await this.getStreams({userName:e.map(Jt)})).data}async getStreamByUserName(e){var t;return(t=(await this.getStreamsByUserNames([e]))[0])!==null&&t!==void 0?t:null}async getStreamsByUserIds(e){return(await this.getStreams({userId:e.map(d)})).data}async getStreamByUserId(e){var t;return(t=(await this.getStreamsByUserIds([e]))[0])!==null&&t!==void 0?t:null}async getStreamMarkersForUser(e,t){return await this._getStreamMarkers("user_id",d(e),t)}getStreamMarkersForUserPaginated(e){return this._getStreamMarkersPaginated("user_id",d(e))}async getStreamMarkersForVideo(e,t){return await this._getStreamMarkers("video_id",e,t)}getStreamMarkersForVideoPaginated(e){return this._getStreamMarkersPaginated("video_id",e)}async createStreamMarker(e,t){try{const r=await this._client.callApi({url:"streams/markers",method:"POST",type:"helix",scope:"channel:manage:broadcast",jsonBody:{user_id:d(e),description:t}});return new wt(r.data[0],this._client)}catch(r){throw r instanceof Xe&&r.statusCode===404?new Dc({cause:r}):r}}async getStreamTags(e){return(await this._client.callApi({type:"helix",url:"streams/tags",query:{broadcaster_id:d(e)}})).data.map(r=>new Qe(r))}async replaceStreamTags(e,t){await this._client.callApi({type:"helix",url:"streams/tags",scope:"channel:manage:broadcast",method:"PUT",query:{broadcaster_id:d(e)},jsonBody:{tag_ids:t}})}async getStreamKey(e){return(await this._client.callApi({type:"helix",url:"streams/key",scope:"channel:read:stream_key",query:{broadcaster_id:d(e)}})).data[0].stream_key}async getFollowedStreams(e,t){const r=await this._client.callApi({type:"helix",url:"streams/followed",scope:"user:read:follows",query:{user_id:d(e),...L(t)}});return te(r,qe,this._client)}getFollowedStreamsPaginated(e){return new z({url:"streams/followed",scope:"user:read:follows",query:{user_id:d(e)}},this._client,t=>new qe(t,this._client))}async _getStreamMarkers(e,t,r){var a;const s=await this._client.callApi({url:"streams/markers",type:"helix",query:{[e]:t,...L(r)},scope:"user:read:broadcast"});return{data:_i(s.data.map(kt._mapGetStreamMarkersResult.bind(this._client))),cursor:(a=s.pagination)===null||a===void 0?void 0:a.cursor}}_getStreamMarkersPaginated(e,t){return new z({url:"streams/markers",query:{[e]:t},scope:"user:read:broadcast"},this._client,kt._mapGetStreamMarkersResult.bind(this._client))}static _mapGetStreamMarkersResult(e){return e.videos.reduce((t,r)=>[...t,...r.markers.map(a=>new qi(a,r.video_id,this))],[])}};Ir=kt=u([w("api","HelixStreamApi")],Ir);let xt=class extends S{constructor(e,t){super(e),this._client=t}get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get isGift(){return this[i].is_gift}get tier(){return this[i].tier}};u([C(!1)],xt.prototype,"_client",void 0);xt=u([w("api","HelixUserSubscription","broadcasterId")],xt);let st=class extends xt{get broadcasterId(){return this[i].broadcaster_id}get broadcasterName(){return this[i].broadcaster_login}get broadcasterDisplayName(){return this[i].broadcaster_name}async getBroadcaster(){return await this._client.users.getUserById(this[i].broadcaster_id)}get gifterId(){return this[i].gifter_id}get gifterName(){return this[i].gifter_login}get gifterDisplayName(){return this[i].gifter_name}async getGifter(){return await this._client.users.getUserById(this[i].gifter_id)}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}};st=u([w("api","HelixSubscription","userId")],st);let Tr=class extends V{async getSubscriptions(e,t){const r=await this._client.callApi({url:"subscriptions",scope:"channel:read:subscriptions",type:"helix",query:{broadcaster_id:d(e),...L(t)}});return{...We(r,st,this._client),points:r.points}}getSubscriptionsPaginated(e){return new Ae({url:"subscriptions",scope:"channel:read:subscriptions",query:{broadcaster_id:d(e)}},this._client,t=>new st(t,this._client))}async getSubscriptionsForUsers(e,t){return(await this._client.callApi({url:"subscriptions",scope:"channel:read:subscriptions",type:"helix",query:{broadcaster_id:d(e),user_id:t.map(d)}})).data.map(a=>new st(a,this._client))}async getSubscriptionForUser(e,t){const r=await this.getSubscriptionsForUsers(e,[t]);return r.length?r[0]:null}async checkUserSubscription(e,t){try{const r=await this._client.callApi({type:"helix",url:"subscriptions/user",scope:"user:read:subscriptions",query:{broadcaster_id:d(t),user_id:d(e)}});return new xt(r.data[0],this._client)}catch(r){if(r instanceof Xe&&r.statusCode===404)return null;throw r}}};Tr=u([w("api","HelixSubscriptionApi")],Tr);let Pr=class extends V{async getAllStreamTags(e){const t=await this._client.callApi({type:"helix",url:"tags/streams",query:L(e)});return te(t,Qe)}getAllStreamTagsPaginated(){return new z({url:"tags/streams"},this._client,e=>new Qe(e))}async getStreamTagsByIds(e){return e.length?(await this._client.callApi({type:"helix",url:"tags/streams",query:{tag_id:e}})).data.map(r=>new Qe(r)):[]}async getStreamTagById(e){var t;return(t=(await this.getStreamTagsByIds([e]))[0])!==null&&t!==void 0?t:null}};Pr=u([w("api","HelixTagApi")],Pr);let St=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get name(){return this[i].team_name}get displayName(){return this[i].team_display_name}get backgroundImageUrl(){return this[i].background_image_url}get bannerUrl(){return this[i].banner}get creationDate(){return new Date(this[i].created_at)}get updateDate(){return new Date(this[i].updated_at)}get info(){return this[i].info}get logoThumbnailUrl(){return this[i].thumbnail_url}async getUserRelations(){return(await this._client.teams.getTeamById(this.id)).userRelations}};u([C(!1)],St.prototype,"_client",void 0);St=u([w("api","HelixTeam","id")],St);let Er=class extends St{get userRelations(){return this[i].users.map(e=>new De(e,this._client))}};Er=u([w("api","HelixTeamWithUsers","id")],Er);let Rr=class extends V{async getTeamsForBroadcaster(e){var t,r;return(r=(t=(await this._client.callApi({type:"helix",url:"teams/channel",query:{broadcaster_id:d(e)}})).data)===null||t===void 0?void 0:t.map(s=>new St(s,this._client)))!==null&&r!==void 0?r:[]}async getTeamById(e){try{const t=await this._client.callApi({type:"helix",url:"teams",query:{id:e}});return new Er(t.data[0],this._client)}catch(t){if(t instanceof Xe&&t.statusCode===500)return null;throw t}}async getTeamByName(e){try{const t=await this._client.callApi({type:"helix",url:"teams",query:{name:e}});return new Er(t.data[0],this._client)}catch(t){if(t instanceof Xe&&t.statusCode===404)return null;throw t}}};Rr=u([w("api","HelixTeamApi")],Rr);class Po extends S{get id(){return this[i].id}get version(){return this[i].version}get name(){return this[i].name}}let ot=class extends Po{constructor(e,t,r){super(r),this._slotType=e,this._slotId=t}get slotType(){return this._slotType}get slotId(){return this._slotId}};ot=u([w("api","HelixInstalledExtension","id")],ot);let Cr=class extends S{getExtensionAtSlot(e,t){const r=this[i][e][t];return r.active?new ot(e,t,r):null}getExtensionsForSlotType(e){return[...Object.entries(this[i][e])].filter(t=>t[1].active).map(([t,r])=>new ot(e,t,r))}getAllExtensions(){return[...Object.entries(this[i])].flatMap(([e,t])=>[...Object.entries(t)].filter(r=>r[1].active).map(([r,a])=>new ot(e,r,a)))}};Cr=u([w("api","HelixInstalledExtensionList")],Cr);let Oi=class extends Po{get canActivate(){return this[i].can_activate}get types(){return this[i].type}};Oi=u([w("api","HelixUserExtension","id")],Oi);let At=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].from_id}get userName(){return this[i].from_login}get userDisplayName(){return this[i].from_name}async getUser(){return await this._client.users.getUserById(this[i].from_id)}get followedUserId(){return this[i].to_id}get followedUserName(){return this[i].to_login}get followedUserDisplayName(){return this[i].to_name}async getFollowedUser(){return await this._client.users.getUserById(this[i].to_id)}get followDate(){return new Date(this[i].followed_at)}};u([C(!1)],At.prototype,"_client",void 0);At=u([w("api","HelixFollow")],At);class Hc extends Fe{constructor(e){super(`Channel ${e} does not have a subscription program`)}}let It=class extends S{constructor(e,t){super(e),this._client=t}get cacheKey(){return this[i].id}get id(){return this[i].id}get name(){return this[i].login}get displayName(){return this[i].display_name}get description(){return this[i].description}get type(){return this[i].type}get broadcasterType(){return this[i].broadcaster_type}get profilePictureUrl(){return this[i].profile_image_url}get offlinePlaceholderUrl(){return this[i].offline_image_url}get views(){return this[i].view_count}get creationDate(){return new Date(this[i].created_at)}async getStream(){return await this._client.streams.getStreamByUserId(this)}async getFollows(){return await this._client.users.getFollows({user:this})}async getFollowFrom(e){return await this._client.users.getFollowFromUserToBroadcaster(e,this)}async getFollowTo(e){return await this._client.users.getFollowFromUserToBroadcaster(this,e)}async follows(e){return await this._client.users.userFollowsBroadcaster(this,e)}async isFollowedBy(e){return await this._client.users.userFollowsBroadcaster(e,this)}async getSubscriptionTo(e){return await this._client.subscriptions.getSubscriptionForUser(e,this)}async isSubscribedTo(e){try{return await this.getSubscriptionTo(e)!==null}catch(t){if(t instanceof Hc)return!1;throw t}}};u([C(!1)],It.prototype,"_client",void 0);It=u([w("api","HelixUser","id")],It);let Br=class extends It{get email(){return this[i].email}async setDescription(e){return await this._client.users.updateUser({description:e})}};Br=u([w("api","HelixPrivilegedUser","id")],Br);let Tt=class extends S{constructor(e,t){super(e),this._client=t}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].display_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}};u([C(!1)],Tt.prototype,"_client",void 0);Tt=u([w("api","HelixUserBlock","userId")],Tt);var Mt;let qr=Mt=class extends V{async getUsersByIds(e){return await this._getUsers("id",e.map(d))}async getUsersByNames(e){return await this._getUsers("login",e.map(Jt))}async getUserById(e){const t=await this._getUsers("id",[d(e)]);return t.length?t[0]:null}async getUserByName(e){const t=await this._getUsers("login",[Jt(e)]);return t.length?t[0]:null}async getMe(e=!1){var t;const r=await this._client.callApi({type:"helix",url:"users",scope:e?"user:read:email":""});if(!(!((t=r.data)===null||t===void 0)&&t.length))throw new Kt("Could not get authenticated user");return new Br(r.data[0],this._client)}async updateUser(e){const t=await this._client.callApi({type:"helix",url:"users",method:"PUT",scope:"user:edit",query:{description:e.description}});return new Br(t.data[0],this._client)}async getFollows(e){const t=await this._client.callApi({url:"users/follows",type:"helix",query:{...Mt._makeFollowsQuery(e),...L(e)}});return We(t,At,this._client)}getFollowsPaginated(e){const t=Mt._makeFollowsQuery(e);return new Ae({url:"users/follows",query:t},this._client,r=>new At(r,this._client))}async getFollowFromUserToBroadcaster(e,t){const{data:r}=await this.getFollows({user:e,followedUser:t});return r.length?r[0]:null}async userFollowsBroadcaster(e,t){return await this.getFollowFromUserToBroadcaster(e,t)!==null}async getBlocks(e,t){const r=await this._client.callApi({type:"helix",url:"users/blocks",scope:"user:read:blocked_users",query:{broadcaster_id:d(e),...L(t)}});return te(r,Tt,this._client)}getBlocksPaginated(e){return new z({url:"users/blocks",scope:"user:read:blocked_users",query:{broadcaster_id:d(e)}},this._client,t=>new Tt(t,this._client))}async createBlock(e,t={}){await this._client.callApi({type:"helix",url:"users/blocks",method:"PUT",scope:"user:manage:blocked_users",query:{target_user_id:d(e),source_context:t.sourceContext,reason:t.reason}})}async deleteBlock(e){await this._client.callApi({type:"helix",url:"users/blocks",method:"DELETE",scope:"user:manage:blocked_users",query:{target_user_id:d(e)}})}async getMyExtensions(){return(await this._client.callApi({type:"helix",url:"users/extensions/list"})).data.map(t=>new Oi(t))}async getActiveExtensions(e){const t=e?d(e):void 0,r=await this._client.callApi({type:"helix",url:"users/extensions",query:{user_id:t}});return new Cr(r.data)}async updateMyActiveExtensions(e){const t=await this._client.callApi({type:"helix",url:"users/extensions",jsonBody:{data:e}});return new Cr(t.data)}static _makeFollowsQuery(e){const t={};let r=!1;if(e.user&&(t.from_id=d(e.user),r=!0),e.followedUser&&(t.to_id=d(e.followedUser),r=!0),!r)throw new TypeError("At least one of user and followedUser have to be set");return t}async _getUsers(e,t){if(t.length===0)return[];const r={[e]:t};return(await this._client.callApi({type:"helix",url:"users",query:r})).data.map(s=>new It(s,this._client))}};qr=Mt=u([w("api","HelixUserApi")],qr);let Ze=class extends S{constructor(e,t){super(e),this._client=t}get id(){return this[i].id}get userId(){return this[i].user_id}get userName(){return this[i].user_login}get userDisplayName(){return this[i].user_name}async getUser(){return await this._client.users.getUserById(this[i].user_id)}get title(){return this[i].title}get description(){return this[i].description}get creationDate(){return new Date(this[i].created_at)}get publishDate(){return new Date(this[i].published_at)}get url(){return this[i].url}get thumbnailUrl(){return this[i].thumbnail_url}getThumbnailUrl(e,t){return this[i].thumbnail_url.replace("%{width}",e.toString()).replace("%{height}",t.toString())}get isPublic(){return this[i].viewable==="public"}get views(){return this[i].view_count}get language(){return this[i].language}get type(){return this[i].type}get duration(){return this[i].duration}get durationInSeconds(){const e=this[i].duration.match(/\d+[hms]/g);if(!e)throw new Kt(`Could not parse duration string: ${this[i].duration}`);return e.map(t=>{const r=/(\d+)([hms])/.exec(t);if(!r)throw new Kt(`Could not parse partial duration string: ${t}`);const[,a,s]=r;return parseInt(a,10)*{h:3600,m:60,s:1}[s]}).reduce((t,r)=>t+r)}get streamId(){return this[i].stream_id}get mutedSegmentData(){return this[i].muted_segments.slice()}isMutedAt(e,t,r=!1){if(t==null)return this[i].muted_segments.some(s=>s.offset<=e&&e<=s.offset+s.duration);const a=e+t;return r?this[i].muted_segments.some(s=>{const o=s.offset+s.duration;return e<o&&s.offset<a}):this[i].muted_segments.some(s=>{const o=s.offset+s.duration;return s.offset<=e&&a<=o})}};u([C(!1)],Ze.prototype,"_client",void 0);u([I()],Ze.prototype,"durationInSeconds",null);Ze=u([Rt,w("api","HelixVideo","id")],Ze);var Gt;let Or=Gt=class extends V{async getVideosByIds(e){return(await this._getVideos("id",e)).data}async getVideoById(e){const t=await this.getVideosByIds([e]);return t.length?t[0]:null}async getVideosByUser(e,t={}){const r=d(e);return await this._getVideos("user_id",[r],t)}getVideosByUserPaginated(e,t={}){const r=d(e);return this._getVideosPaginated("user_id",[r],t)}async getVideosByGame(e,t={}){return await this._getVideos("game_id",[e],t)}getVideosByGamePaginated(e,t={}){return this._getVideosPaginated("game_id",[e],t)}async deleteVideosByIds(e){await this._client.callApi({type:"helix",url:"videos",method:"DELETE",scope:"channel:manage:videos",query:{id:e}})}async _getVideos(e,t,r={}){if(!t.length)return{data:[]};const a=await this._client.callApi({url:"videos",type:"helix",query:{...Gt._makeVideosQuery(e,t,r),...L(r)}});return te(a,Ze,this._client)}_getVideosPaginated(e,t,r={}){return new z({url:"videos",query:Gt._makeVideosQuery(e,t,r)},this._client,a=>new Ze(a,this._client))}static _makeVideosQuery(e,t,r={}){const{language:a,period:s,orderBy:o,type:l}=r;return{[e]:t,language:a,period:s,sort:o,type:l}}};Or=Gt=u([w("api","HelixVideoApi")],Or);let K=class extends V{get bits(){return new Zt(this._client)}get channels(){return new rr(this._client)}get channelPoints(){return new nr(this._client)}get chat(){return new lr(this._client)}get clips(){return new ur(this._client)}get eventSub(){return new cr(this._client)}get extensions(){return new pr(this._client)}get games(){return new hr(this._client)}get goals(){return new yr(this._client)}get hypeTrain(){return new Io(this._client)}get moderation(){return new _r(this._client)}get polls(){return new vr(this._client)}get predictions(){return new xr(this._client)}get schedule(){return new To(this._client)}get search(){return new Ar(this._client)}get streams(){return new Ir(this._client)}get subscriptions(){return new Tr(this._client)}get tags(){return new Pr(this._client)}get teams(){return new Rr(this._client)}get users(){return new qr(this._client)}get videos(){return new Or(this._client)}};u([I()],K.prototype,"bits",null);u([I()],K.prototype,"channels",null);u([I()],K.prototype,"channelPoints",null);u([I()],K.prototype,"chat",null);u([I()],K.prototype,"clips",null);u([I()],K.prototype,"eventSub",null);u([I()],K.prototype,"extensions",null);u([I()],K.prototype,"games",null);u([I()],K.prototype,"goals",null);u([I()],K.prototype,"hypeTrain",null);u([I()],K.prototype,"moderation",null);u([I()],K.prototype,"polls",null);u([I()],K.prototype,"predictions",null);u([I()],K.prototype,"schedule",null);u([I()],K.prototype,"search",null);u([I()],K.prototype,"streams",null);u([I()],K.prototype,"subscriptions",null);u([I()],K.prototype,"tags",null);u([I()],K.prototype,"teams",null);u([I()],K.prototype,"users",null);u([I()],K.prototype,"videos",null);K=u([Rt,w("api","HelixApiGroup")],K);class Ft extends Yu{async doRequest({options:e,clientId:t,accessToken:r,authorizationType:a,fetchOptions:s}){return await Qt(e,t,r,a,s)}needsToRetryAfter(e){return e.status===429&&(!e.headers.has("ratelimit-remaining")||Number(e.headers.get("ratelimit-remaining"))===0)?+e.headers.get("ratelimit-reset")*1e3-Date.now():null}getParametersFromResponse(e){const t=e.headers;return{limit:+t.get("ratelimit-limit"),remaining:+t.get("ratelimit-remaining"),resetsAt:+t.get("ratelimit-reset")*1e3}}}let Di=class extends S{get creationDate(){return new Date(this[i].created_at)}get targetIsMature(){return this[i].is_mature}};Di=u([w("api","HelixRaid")],Di);let Hi=class extends V{async startRaid(e,t){const r=await this._client.callApi({type:"helix",url:"raids",method:"POST",query:{from_broadcaster_id:d(e),to_broadcaster_id:d(t)}});return new Di(r.data[0])}async cancelRaid(e){await this._client.callApi({type:"helix",url:"raids",method:"DELETE",query:{broadcaster_id:d(e)}})}};Hi=u([w("api","HelixRaidApi")],Hi);let Ui=class extends V{async sendWhisper(e,t,r){await this._client.callApi({type:"helix",url:"whispers",method:"POST",scope:"user:manage:whispers",query:{from_user_id:d(e),to_user_id:d(t)},jsonBody:{message:r}})}};Ui=u([w("api","HelixWhisperApi")],Ui);let Fi=class extends S{get allChatters(){return _i(Object.values(this[i].chatters))}get allChattersWithStatus(){return new Map(_i(Object.entries(this[i].chatters).map(([e,t])=>t.map(r=>[r,e]))))}};Fi=u([w("api","ChattersList")],Fi);let Ni=class extends V{async getChatters(e){const t=Jt(e),r=await this._client.callApi({url:`https://tmi.twitch.tv/group/user/${t}/chatters`,type:"custom"});return new Fi(r)}};Ni=u([w("api","UnsupportedApi")],Ni);class Uc extends Fe{}let $=class{constructor(e){if(!e.authProvider)throw new Uc("No auth provider given. Please supply the `authProvider` option.");this._config=e,this._logger=ki({name:"twurple:api:client",...e.logger});const t={name:"twurple:api:rate-limiter",...e.logger};this._rateLimiter=el?new Ft({logger:t}):new Xu({logger:t,bucketSize:800,timeFrame:64e3,doRequest:async({options:r,clientId:a,accessToken:s,authorizationType:o,fetchOptions:l})=>await Qt(r,a,s,o,l)})}async requestScopes(e){await this._config.authProvider.getAccessToken(e)}async getTokenInfo(){try{const e=await this.callApi({type:"auth",url:"validate"});return new Si(e)}catch(e){throw e instanceof Xe&&e.statusCode===401?new Rc({cause:e}):e}}async callApi(e){var t;const{authProvider:r}=this._config;let s=((t=e.auth)!==null&&t!==void 0?t:!0)?await r.getAccessToken(e.scope?[e.scope]:void 0):null;if(!s)return await bc(e,r.clientId,void 0,void 0,this._config.fetchOptions);if(Ao(s)&&r.refresh){const c=await r.refresh();c&&(s=c)}const o=r.authorizationType;let l=await this._callApiInternal(e,r.clientId,s.accessToken,o);return l.status===401&&r.refresh&&(await r.refresh(),s=await r.getAccessToken(e.scope?[e.scope]:[]),s&&(l=await this._callApiInternal(e,r.clientId,s.accessToken,o))),await xo(l,e),await So(l)}get helix(){return new K(this)}get bits(){return new Zt(this)}get channels(){return new rr(this)}get channelPoints(){return new nr(this)}get chat(){return new lr(this)}get clips(){return new ur(this)}get eventSub(){return new cr(this)}get extensions(){return new pr(this)}get games(){return new hr(this)}get hypeTrain(){return new Io(this)}get goals(){return new yr(this)}get moderation(){return new _r(this)}get polls(){return new vr(this)}get predictions(){return new xr(this)}get raids(){return new Hi(this)}get schedule(){return new To(this)}get search(){return new Ar(this)}get streams(){return new Ir(this)}get subscriptions(){return new Tr(this)}get tags(){return new Pr(this)}get teams(){return new Rr(this)}get users(){return new qr(this)}get videos(){return new Or(this)}get whispers(){return new Ui(this)}get badges(){return new Ti(this)}get unsupported(){return new Ni(this)}get lastKnownLimit(){return this._rateLimiter instanceof Ft?this._rateLimiter.lastKnownLimit:null}get lastKnownRemainingRequests(){return this._rateLimiter instanceof Ft?this._rateLimiter.lastKnownRemainingRequests:null}get lastKnownResetDate(){return this._rateLimiter instanceof Ft?this._rateLimiter.lastKnownResetDate:null}get _authProvider(){return this._config.authProvider}async _callApiInternal(e,t,r,a){var s,o,l;const{fetchOptions:c}=this._config,h=(s=e.type)!==null&&s!==void 0?s:"helix";this._logger.debug(`Calling ${h} API: ${(o=e.method)!==null&&o!==void 0?o:"GET"} ${e.url}`),this._logger.trace(`Query: ${JSON.stringify(e.query)}`),e.jsonBody&&this._logger.trace(`Request body: ${JSON.stringify(e.jsonBody)}`);const g=h==="helix"?await this._rateLimiter.request({options:e,clientId:t,accessToken:r,authorizationType:a,fetchOptions:c}):await Qt(e,t,r,a,c);return this._logger.debug(`Called ${h} API: ${(l=e.method)!==null&&l!==void 0?l:"GET"} ${e.url} - result: ${g.status}`),g}};u([I()],$.prototype,"helix",null);u([I()],$.prototype,"bits",null);u([I()],$.prototype,"channels",null);u([I()],$.prototype,"channelPoints",null);u([I()],$.prototype,"chat",null);u([I()],$.prototype,"clips",null);u([I()],$.prototype,"eventSub",null);u([I()],$.prototype,"extensions",null);u([I()],$.prototype,"games",null);u([I()],$.prototype,"hypeTrain",null);u([I()],$.prototype,"goals",null);u([I()],$.prototype,"moderation",null);u([I()],$.prototype,"polls",null);u([I()],$.prototype,"predictions",null);u([I()],$.prototype,"raids",null);u([I()],$.prototype,"schedule",null);u([I()],$.prototype,"search",null);u([I()],$.prototype,"streams",null);u([I()],$.prototype,"subscriptions",null);u([I()],$.prototype,"tags",null);u([I()],$.prototype,"teams",null);u([I()],$.prototype,"users",null);u([I()],$.prototype,"videos",null);u([I()],$.prototype,"whispers",null);u([I()],$.prototype,"badges",null);u([I()],$.prototype,"unsupported",null);$=u([Rt,w("api","ApiClient")],$);module.exports=function(n){n.extensions.twitch&&console.log("Twitch Extension properties:",JSON.stringify(Object.keys(n.extensions.twitch)));var e=!1;const t=n.Replicant("streamStartCurrentState",{defaultValue:"starting",persistent:!1}),r=n.Replicant("streamStartProgress",{defaultValue:0,persistent:!1});n.Replicant("streamStartTime",{defaultValue:new Date,persistent:!0});const a=n.Replicant("streamStartStates",{defaultValue:{starting:{length:5,loadingText:"loading",video:""},brb:{length:5,loadingText:"loading",video:""},ending:{length:5,loadingText:"loading",video:""},custom:{length:5,loadingText:"loading",video:""}},persistent:!0}),s=process,o=s.env.CLIENT_ID,l=s.env.CLIENT_SECRET,c=new ut(o,l),h=new $({authProvider:c});let g=a.value[t.value];r.value=0,n.listenFor("getUserAvatar",async(T,D)=>{const k=await h.users.getUserByName(T);if(!k){D(new Error("User not found"));return}D&&!D.handled&&D.handled==!1&&D(null,k.profilePictureUrl)});let v=(g.length*600).toString()+"m";var _=new Yo;function m(){r.value>=1?(_.clearInterval(),r.value=1):r.value+=.01}function x(T){T===t.value||!["starting","brb","ending","custom"].includes(T)||(t.value=T,n.log.info("State changed to "+T,a.value[T]))}r.on("change",function(T,D){D==1&&T!=1?(r.value=T,_.clearInterval(),_.setInterval(m,[],v)):D!==void 0&&D!=1&&T==1&&_.clearInterval()});function B(T,D){g=a.value[t.value],g.length>0&&(v=(g.length*600).toString()+"m",_.clearInterval(),e&&_.setInterval(m,[],v)),typeof T=="string"&&(r.value=0)}t.on("change",B),a.on("change",B),n.listenFor("changeState",T=>{x(T)}),n.listenFor("start",()=>{g.length>0&&!e&&(_.setInterval(m,[],v),e=!0)}),n.listenFor("restart",()=>{r.value=0}),n.listenFor("stop",()=>{e&&(_.clearInterval(),e=!1)})};
//# sourceMappingURL=index.js.map
